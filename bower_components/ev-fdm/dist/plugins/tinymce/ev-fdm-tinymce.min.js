!function(e){var t={menubar:!1,statusbar:!1,toolbar:"bold italic underline | alignleft aligncenter alignright | bullist",skin:!1,verify_html:!0,convert_fonts_to_spans:!0,inline:!0,browser_spellcheck:!0};angular.module("ev-tinymce",[]).provider("evTinymce",function(){var e={};this.register=function(t,n){if(e.hasOwnProperty(t))throw new Error('A config named "'+t+'" was already registered');e[t]=n},this.get=function(t){return e[t]},this.$get=function(){return e}}).directive("evTinymce",["$timeout","evTinymce",function(n,i){var o=0;return{template:'<div class="tiny-mce-wrapper form-control"><div class="ev-placeholder-container"></div><div class="ev-tinymce-content"></div><div ng-click="focusTinymce()" class="ev-tinymce-toolbar"></div><div class="max-chars-info"></div></div>',restrict:"AE",replace:!0,require:"?ngModel",scope:{tinymceOptions:"="},link:function(a,r,c,l){var s="uiTinymce"+o++,d=r.find(".ev-tinymce-content");d.attr("id",s),r.find(".ev-tinymce-toolbar").attr("id",s+"toolbar");var u,m=function(){return u||(u=e.get(s)),u},v=angular.extend({fixed_toolbar_container:"#"+s+"toolbar"},t,i[c.configKey],a.tinymceOptions),f=v.maxChars=c.maxChars||v.maxChars||null,g=85,h=function(e,t){var n=r.parent().find(".max-chars-info");n.text(e+" / "+t);var i=e/t*100>g,o=e>=t;n.toggleClass("max-chars-warning",i),n.toggleClass("max-chars-reached",o)},p=!1,y=!1,b="",x="",C=function(){var e=m();tinymce.DOM.addClass(d,"placeholder-light"),e.setContent(c.placeholder)},T=function(e){var t=m();p?x===c.placeholder&&(t.setContent(""),t.selection.setCursorLocation(),tinymce.DOM.removeClass(d,"placeholder-light")):e!==c.placeholder&&C()},w=function(){var e=m(),t=d.html(),i=d.text(),o=f&&i.length>f,a=f&&x.length>f;if(y&&i===c.placeholder)b=t,x=i;else if(!o||!a&&x.length)a&&o?e.setContent(b):(n(function(){l.$setViewValue(""===i||i===c.placeholder?"":t)}),b=t,x=i);else{var r=i.substr(0,f);e.setContent(r,{format:"text"})}f&&h(x.length,f),y=""===i||i===c.placeholder,y&&c.placeholder&&T(i)};l.$render=function(){var e=m();e&&(l.$viewValue?e.setContent(l.$viewValue):c.placeholder&&(y=!0,C()))},a.focusTinymce=function(){var e=m();e&&e.focus()};var A=function(e){e.on("init",function(){l.$viewValue&&l.$render()}),e.on("ExecCommand",function(){w()}),e.on("KeyUp",function(){w()}),e.on("SetContent",function(e){e.initial||w()}),e.on("blur",function(){p&&(p=!1,w()),d.blur()}),e.on("focus",function(){p||(p=!0,w())})};v.setup=A,v.elems=s,v.mode="exact",e.init(v),a.$on("$destroy",function(){var e=m();e&&e.destroy()}),e.execCommand("mceToggleEditor",!1,s)}}}])}(window.tinyMCE),tinymce.PluginManager.add("evelements",function(e){function t(t){return function(){var n=e.dom,i=e.selection.getNode();i&&t.matches(i)?n.remove(i,!0):e.insertContent(n.createHTML(t.name,{},n.encode(e.selection.getContent({format:"text"}))))}}function n(t){return function(){var n=e.dom,i=e.selection.getNode(),a=null;if(i&&t.matches(i)){a={};for(var r=n.getAttribs(i),c=0;c<r.length;++c){var l=r[c];a[l.name]=l.value}}else i=null;var s=t.key||t.name,d=o[s]&&o[s].callback,u=i?"innerText"in i?i.innerText:i.textContent:e.selection.getContent({format:"text"});(d||t.callback)(a,function(o,a){if(i){if(e.focus(),!o&&!a)return n.remove(i,!0),void e.undoManager.add();n.removeAllAttribs(i),n.setAttribs(i,o),a&&("innerText"in i?i.innerText=a:i.textContent=a),e.selection.select(i),e.undoManager.add()}else e.focus(),i=n.createHTML(t.name,o,a&&n.encode(a)),e.selection.setContent(i),e.undoManager.add()},u,o)}}var i=e.settings.evelements,o=e.settings.evelementsOptions;"string"==typeof i&&(i=i.split(" ")),i.forEach(function(i){"string"==typeof i&&(i={name:i}),i.matches=i.matches||function(e){return e.nodeName.toLowerCase()===i.name};var o=i.callback?n(i):t(i);e.addButton("ev"+(i.key||i.name),{text:void 0!==i.title?i.title:i.name,icon:i.icon,tooltip:i.tooltip||"Set this text as "+i.name,shortcut:i.shortcut,onclick:o,stateSelector:i.selector||i.name}),i.shortcut&&e.addShortcut(i.shortcut,"",o)})}),tinymce.PluginManager.add("evimage",function(e){function t(){var t=e.dom,n=e.selection.getNode(),i=null;n&&n.getAttribute("data-picture-id")&&(i={src:t.getAttrib(n,"src"),alt:t.getAttrib(n,"alt"),"class":t.getAttrib(n,"class"),"data-picture-id":t.getAttrib(n,"data-picture-id")}),e.settings.evimage(i,function(o){i?(t.removeAllAttribs(n),t.setAttribs(n,o)):e.selection.setContent(e.dom.createHTML("img",o))})}console.log("evimage is deprecated: use evelements"),e.addButton("evimage",{icon:"image",tooltip:"Insert/edit image",onclick:t,stateSelector:"img[data-picture-id]:not([data-mce-object],[data-mce-placeholder])"}),e.addMenuItem("evimage",{icon:"image",text:"Insert image",onclick:t,context:"insert",prependToContext:!0}),e.addCommand("mceImage",t)});
//# sourceMappingURL=ev-fdm-tinymce.min.js.map