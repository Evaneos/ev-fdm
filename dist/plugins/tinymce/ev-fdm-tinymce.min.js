!function(e){var t={menubar:!1,statusbar:!1,toolbar:"bold italic underline | alignleft aligncenter alignright | bullist",skin:!1,verify_html:!0,convert_fonts_to_spans:!0,inline:!0};angular.module("ev-tinymce",[]).directive("evTinymce",["$timeout",function(n){var i=0;return{template:'<div class="tiny-mce-wrapper"><div class="ev-placeholder-container"></div><div class="ev-tinymce-content"></div><div ng-click="focusTinymce()" class="ev-tinymce-toolbar"></div><div class="max-chars-info"></div></div>',restrict:"AE",replace:!0,require:"?ngModel",scope:{tinymceOptions:"="},link:function(o,a,c,r){var l="uiTinymce"+i++,s=a.find(".ev-tinymce-content");s.attr("id",l),a.find(".ev-tinymce-toolbar").attr("id",l+"toolbar");var d,u=function(){return d||(d=e.get(l)),d},m=angular.extend({fixed_toolbar_container:"#"+l+"toolbar"},t,o.tinymceOptions),v=m.maxChars=c.maxChars||m.maxChars||null,g=85,f=function(e,t){var n=a.parent().find(".max-chars-info");n.text(e+" / "+t);var i=e/t*100>g,o=e>=t;n.toggleClass("max-chars-warning",i),n.toggleClass("max-chars-reached",o)},p=!1,h=!1,b="",x="",C=function(){var e=u();e.setContent('<span class="placeholder-light">'+c.placeholder+"</span>")},y=function(e){var t=u();p?x===c.placeholder&&(t.setContent(""),t.selection.setCursorLocation()):e!==c.placeholder&&C()},w=function(){var e=u(),t=s.html(),i=s.text(),o=v&&i.length>v,a=v&&x.length>v;if(h&&i===c.placeholder)b=t,x=i;else if(!o||!a&&x.length)a&&o?e.setContent(b):(n(function(){r.$setViewValue(""===i||i===c.placeholder?"":t)}),b=t,x=i);else{var l=i.substr(0,v);e.setContent(l,{format:"text"})}v&&f(x.length,v),h=""===i||i===c.placeholder,h&&c.placeholder&&y(i)};r.$render=function(){var e=u();e&&(r.$viewValue?e.setContent(r.$viewValue):c.placeholder&&(h=!0,C()))},o.focusTinymce=function(){var e=u();e&&e.focus()};var A=function(e){e.on("init",function(){r.$viewValue&&r.$render()}),e.on("ExecCommand",function(){w()}),e.on("KeyUp",function(){w()}),e.on("SetContent",function(e){e.initial||w()}),e.on("blur",function(){p&&(p=!1,w()),s.blur()}),e.on("focus",function(){p||(p=!0,w())})};m.setup=A,m.elems=l,m.mode="exact",e.init(m),o.$on("$destroy",function(){var e=u();e&&e.destroy()}),e.execCommand("mceToggleEditor",!1,l)}}}])}(window.tinyMCE),tinymce.PluginManager.add("evelements",function(e){function t(t){return function(){var n=e.dom,i=e.selection.getNode();i&&i.nodeName.toLowerCase()===t?n.remove(i,!0):e.insertContent(n.createHTML(t,{},n.encode(e.selection.getContent({format:"text"}))))}}e.settings.evelements.split(" ").forEach(function(n){e.addButton("ev"+n,{text:n,tooltip:"Set this text as "+n,onclick:t(n),stateSelector:n})})}),tinymce.PluginManager.add("evimage",function(e){function t(){var t=e.dom,n=e.selection.getNode(),i=null;n&&n.getAttribute("data-picture-id")&&(i={src:t.getAttrib(n,"src"),alt:t.getAttrib(n,"alt"),"class":t.getAttrib(n,"class"),"data-picture-id":t.getAttrib(n,"data-picture-id")}),e.settings.evimage(i,function(o){i?(t.removeAllAttribs(n),t.setAttribs(n,o)):e.selection.setContent(e.dom.createHTML("img",o))})}e.addButton("evimage",{icon:"image",tooltip:"Insert/edit image",onclick:t,stateSelector:"img[data-picture-id]:not([data-mce-object],[data-mce-placeholder])"}),e.addMenuItem("evimage",{icon:"image",text:"Insert image",onclick:t,context:"insert",prependToContext:!0}),e.addCommand("mceImage",t)});
//# sourceMappingURL=ev-fdm-tinymce.min.js.map