!function(e){var t={menubar:!1,statusbar:!1,toolbar:"bold italic underline | alignleft aligncenter alignright | bullist",skin:!1,verify_html:!0,convert_fonts_to_spans:!0,inline:!0};angular.module("ev-tinymce",[]).provider("evTinymce",function(){var e={};this.register=function(t,n){if(e.hasOwnProperty(t))throw new Error('A config named "'+t+'" was already registered');e[t]=n},this.get=function(t){return e[t]},this.$get=function(){return e}}).directive("evTinymce",["$timeout","evTinymce",function(n,i){var o=0;return{template:'<div class="tiny-mce-wrapper"><div class="ev-placeholder-container"></div><div class="ev-tinymce-content"></div><div ng-click="focusTinymce()" class="ev-tinymce-toolbar"></div><div class="max-chars-info"></div></div>',restrict:"AE",replace:!0,require:"?ngModel",scope:{tinymceOptions:"="},link:function(a,r,c,l){var s="uiTinymce"+o++,d=r.find(".ev-tinymce-content");d.attr("id",s),r.find(".ev-tinymce-toolbar").attr("id",s+"toolbar");var u,m=function(){return u||(u=e.get(s)),u},g=angular.extend({fixed_toolbar_container:"#"+s+"toolbar"},t,i[c.configKey],a.tinymceOptions),v=g.maxChars=c.maxChars||g.maxChars||null,f=85,p=function(e,t){var n=r.parent().find(".max-chars-info");n.text(e+" / "+t);var i=e/t*100>f,o=e>=t;n.toggleClass("max-chars-warning",i),n.toggleClass("max-chars-reached",o)},h=!1,y=!1,b="",x="",C=function(){var e=m();e.setContent('<span class="placeholder-light">'+c.placeholder+"</span>")},w=function(e){var t=m();h?x===c.placeholder&&(t.setContent(""),t.selection.setCursorLocation()):e!==c.placeholder&&C()},A=function(){var e=m(),t=d.html(),i=d.text(),o=v&&i.length>v,a=v&&x.length>v;if(y&&i===c.placeholder)b=t,x=i;else if(!o||!a&&x.length)a&&o?e.setContent(b):(n(function(){l.$setViewValue(""===i||i===c.placeholder?"":t)}),b=t,x=i);else{var r=i.substr(0,v);e.setContent(r,{format:"text"})}v&&p(x.length,v),y=""===i||i===c.placeholder,y&&c.placeholder&&w(i)};l.$render=function(){var e=m();e&&(l.$viewValue?e.setContent(l.$viewValue):c.placeholder&&(y=!0,C()))},a.focusTinymce=function(){var e=m();e&&e.focus()};var T=function(e){e.on("init",function(){l.$viewValue&&l.$render()}),e.on("ExecCommand",function(){A()}),e.on("KeyUp",function(){A()}),e.on("SetContent",function(e){e.initial||A()}),e.on("blur",function(){h&&(h=!1,A()),d.blur()}),e.on("focus",function(){h||(h=!0,A())})};g.setup=T,g.elems=s,g.mode="exact",e.init(g),a.$on("$destroy",function(){var e=m();e&&e.destroy()}),e.execCommand("mceToggleEditor",!1,s)}}}])}(window.tinyMCE),tinymce.PluginManager.add("evelements",function(e){function t(t){return function(){var n=e.dom,i=e.selection.getNode();i&&i.nodeName.toLowerCase()===t?n.remove(i,!0):e.insertContent(n.createHTML(t,{},n.encode(e.selection.getContent({format:"text"}))))}}e.settings.evelements.split(" ").forEach(function(n){e.addButton("ev"+n,{text:n,tooltip:"Set this text as "+n,onclick:t(n),stateSelector:n})})}),tinymce.PluginManager.add("evimage",function(e){function t(){var t=e.dom,n=e.selection.getNode(),i=null;n&&n.getAttribute("data-picture-id")&&(i={src:t.getAttrib(n,"src"),alt:t.getAttrib(n,"alt"),"class":t.getAttrib(n,"class"),"data-picture-id":t.getAttrib(n,"data-picture-id")}),e.settings.evimage(i,function(o){i?(t.removeAllAttribs(n),t.setAttribs(n,o)):e.selection.setContent(e.dom.createHTML("img",o))})}e.addButton("evimage",{icon:"image",tooltip:"Insert/edit image",onclick:t,stateSelector:"img[data-picture-id]:not([data-mce-object],[data-mce-placeholder])"}),e.addMenuItem("evimage",{icon:"image",text:"Insert image",onclick:t,context:"insert",prependToContext:!0}),e.addCommand("mceImage",t)});
//# sourceMappingURL=ev-fdm-tinymce.min.js.map