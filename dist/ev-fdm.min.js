function MenuManagerProvider(){function e(e){var t=null;return angular.forEach(n.tabs,function(n){e===n.state&&(t=n)}),t}function t(t){t=t||{},t=e(t.state),t&&(n.activeTab&&(n.lastTab=n.activeTab,n.activeTab.active=!1),t.active=!0,n.activeTab=t)}var n=this;this.tabs=[],this.activeTab=null,this.lastTab=null,this.addTab=function(e){return this.tabs.push(e),this},this.$get=["$rootScope","$state",function(r){return r.$on("$stateChangeStart",function(n,r,a,i){if(""===i.name){var o=e(r.name);o&&t(o)}}),r.$on("$stateChangeError",function(){t(n.lastTab)}),{tabs:n.tabs,selectTab:t}}]}function EvMenuDirective(e){return{restrict:"E",replace:!0,template:'<ul class="module-tabs ev-header nav nav-tabs" ng-cloak><li ng-repeat="tab in tabs" ng-class="{active: tab.active}"><a ng-click="selectTab(tab)">{{ tab.name }}</a></li></ul>',controller:["$scope","$state","$rootScope",function(t,n,r){t.tabs=e.tabs,r["evmenu-state"]&&e.selectTab(r["evmenu-state"]),t.selectTab=function(t){e.selectTab(t),n.go(t.state)}}]}}function FilterServiceFactory(e,t){function n(){this.filters={};var n=[],r=this;e.$watch(function(){return r.filters},function(e,n){n!==e&&t(function(){r.modifier?r.modifier.call(r,e,n):r.callListeners()},0)},!0),this.setModifier=function(e){angular.isFunction(e)&&(this.modifier=e)},this.addListener=function(e,t){angular.isFunction(t)&&(n.push(t),e.$on("$destroy",function(){r.removeListener(t)}))},this.removeListener=function(e){angular.forEach(n,function(t,r){t===e&&n.splice(r,1)})},this.callListeners=function(){var e=this;angular.forEach(n,function(t){t(e.filters)})}}return new n}angular.module("ev-fdm",["ui.router","ui.date","chieffancypants.loadingBar","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.select2","angularMoment","ngAnimate","checklist-model","ui.bootstrap","restangular"]).config(["cfpLoadingBarProvider",function(e){e.includeSpinner=!1,e.parentSelector="#menu"}]).config(["$tooltipProvider",function(e){e.options({placement:"bottom",popupDelay:100}),e.setTriggers({mouseenter:"mouseleave",click:"click",focus:"blur",never:"mouseleave","focus-not-typing":"blur-or-typing"})}]).config(["RestangularProvider",function(){}]).run(["$rootScope","$state","$location","uiSelect2Config",function(e,t,n,r){r.minimumResultsForSearch=7,r.allowClear=!0,e.$on("$stateChangeStart",function(t,n){n.state=n.name.split(".")[0],e["evmenu-state"]=n}),window.moment.lang([window.navigator.language,"en"])}]),angular.module("ev-fdm").animation(".ev-animate-picture-list",function(){return{enter:function(e,t){e.width();return e.css("opacity",0),jQuery(e).animate({opacity:1},300,t),function(t){t&&jQuery(e).stop()}},leave:function(e,t){return e.css("opacity",1),jQuery(e).animate({opacity:.3},300,t),function(t){t&&jQuery(e).stop()}},move:function(e,t){return e.css("opacity",0),jQuery(e).animate({opacity:1},t),function(t){t&&jQuery(e).stop()}},addClass:function(){},removeClass:function(){}}}),angular.module("ev-fdm").animation(".ev-animate-tag-list",function(){return{enter:function(e,t){return e.css("opacity",0),jQuery(e).animate({opacity:1},300,t),function(t){t&&jQuery(e).stop()}},leave:function(e,t){return e.css("opacity",1),jQuery(e).animate({opacity:.3},300,t),function(t){t&&jQuery(e).stop()}},move:function(e,t){return e.css("opacity",0),jQuery(e).animate({opacity:1},t),function(t){t&&jQuery(e).stop()}},addClass:function(){},removeClass:function(){}}}),angular.module("ev-fdm").factory("ListController",["$rootScope","$state","$stateParams","Restangular",function(e,t,n,r){function a(t,n,r,a,i,o){"object"==typeof n&&(i=n.defaultReverseSort,a=n.defaultSortKey,r=n.elements,o=n.activeIdSelector||"id",n=n.elementName),this.elementName=n,this.defaultSortKey=a,this.defaultReverseSort=i,this.activeIdSelector=o||"id",this.$scope=t,this.$scope.filters={},this.$scope.sortKey=this.defaultSortKey,this.$scope.reverseSort=this.defaultReverseSort,this.setElements(r),this.$scope.changePage=function(t){var n=angular.copy(arguments);Array.prototype.unshift.call(n,"common::pagination.changed",this.$scope.currentPage,t),e.$broadcast.apply(e,n),this.update(t,this.$scope.filters,this.sortKey,this.reverseSort)}.bind(this),this.$scope.sortChanged=function(){var t=angular.copy(arguments);return Array.prototype.unshift.call(t,"common::sort.changed",this.$scope.sortKey,this.$scope.reverseSort),e.$broadcast.apply(e,t),this.update(1,this.$scope.filters,this.$scope.sortKey,this.$scope.reverseSort)}.bind(this),this.$scope.filtersChanged=function(){var t=angular.copy(arguments);return Array.prototype.unshift.call(t,"common::filters.changed",this.$scope.filters),e.$broadcast.apply(e,t),this.update(1,this.$scope.filters,this.$scope.sortKey,this.$scope.reverseSort)}.bind(this),this.$scope.toggleDetailView=function(e){this.toggleView("view",e)}.bind(this),this.$scope.$on("$stateChangeSuccess",function(e,t){t.name===this.elementName?this.$scope.activeElement=null:this.setActiveElement()}.bind(this)),this.$scope.$on(this.elementName+"::updated",function(){this.update(this.$scope.currentPage,this.$scope.filters,this.$scope.sortKey,this.$scope.reverseSort)}.bind(this)),this.$scope.$on(this.elementName+"::created",function(){this.update(this.$scope.currentPage,this.$scope.filters,this.$scope.sortKey,this.$scope.reverseSort)}.bind(this)),this.$scope.$on(this.elementName+"::deleted",function(){this.update(this.$scope.currentPage,this.$scope.filters,this.$scope.sortKey,this.$scope.reverseSort)}.bind(this))}return a.prototype.update=function(e,t,n,r){return this.fetch(e,t,n,r).then(function(e){return this.setElements(e),e}.bind(this))},a.prototype.setElements=function(e){if(this.$scope[this.elementName]=e,this.$scope.currentPage=e.pagination.current_page,this.$scope.pageCount=e.pagination.total_pages,this.$scope.totalElement=e.pagination.total,this.$scope.selectedElements&&this.$scope[this.elementName]){var t=this.$scope[this.elementName].map(function(e){return r.configuration.getIdFromElem(e)});this.$scope.selectedElements=this.$scope.selectedElements.filter(function(e){return-1!==t.indexOf(r.configuration.getIdFromElem(e))})}else this.$scope.selectedElements=[];this.setActiveElement()},a.prototype.setActiveElement=function(){this.$scope.activeElement=null,angular.isDefined(t.params[this.activeIdSelector])&&angular.forEach(this.$scope[this.elementName],function(e){r.configuration.getIdFromElem(e)==t.params[this.activeIdSelector]&&(this.$scope.activeElement=e)}.bind(this))},a.prototype.toggleView=function(a,i,o){if(!i)return e.$broadcast("common::list.toggleView",a,"close"),void t.go(this.goToViewStatePath(!1));var s=r.configuration.getIdFromElem(i);if(s&&n.id!==s){var l={};l[this.activeIdSelector]=s,angular.extend(l,o),e.$broadcast("common::list.toggleView",a,"open"),t.go(this.goToViewStatePath(a,i),l)}else e.$broadcast("common::list.toggleView",a,"close"),t.go(this.goToViewStatePath(!1))},a.prototype.goToViewStatePath=function(e){return this.elementName+(e?"."+e:"")},a}]);var NotificationsController=["$scope","NotificationsService",function(e,t){e.notifications=t.list,e.$watch(function(){return t.activeNotification},function(){e.activeNotification=t.activeNotification}),e.getClass=function(e){if(!e)return"";switch(e.type){case t.type.ERROR:return"danger";case t.type.SUCCESS:return"success";case t.type.WARNING:return"warning";case t.type.INFO:return"info";default:return"success"}},e.remove=function(e){t.remove(e)}}];angular.module("ev-fdm").controller("NotificationsController",NotificationsController),angular.module("ev-fdm").factory("SearchController",["$rootScope",function(e){function t(t){this.$scope=t,this.$scope.filters={},t.filtersChanged=function(){Array.prototype.unshift.call(arguments,"common::filters.changed",this.$scope.filters),e.$broadcast.apply(e,arguments)}.bind(this)}return t}]);var module=angular.module("ev-fdm");module.directive("evAccordion",["accordionDirective",function(){return{restrict:"A",require:"accordion",link:function(e,t,n,r){function a(e){r.groups.forEach(function(t){t.isOpen=e})}function i(e){var t=r.groups;return 0===t.length?!1:"expand"===e?t.every(function(e){return!e.isOpen}):t.some(function(e){return e.isOpen})}e.expandAll=a.bind(null,!0),e.collapseAll=a.bind(null,!1),e.showableAccordionButton=i}}}]),angular.module("ev-fdm").directive("activableSet",function(){return{restrict:"A",scope:!1,controller:["$scope","$attrs","$parse",function(e,t,n){var r=n(t.activeElement),a=r.assign,i=this;e.$watch(function(){return r(e)},function(e){i.activeElement=e}),this.toggleActive=function(n){n!==this.activeElement?(a&&a(e,n),this.activeElement=n):(a&&a(e,null),this.activeElement=void 0),e.$eval(t.activeChange)}}]}}),angular.module("ev-fdm").directive("activable",["$parse",function(e){return{restrict:"A",require:"^activableSet",link:function(t,n,r,a){n.addClass("clickable");var i=e(r.activable),o=i(t);t.$watch(function(){return i(t)},function(e){o=e}),t.$watch(function(){return a.activeElement},function(e){e&&o===e?n.addClass("active"):n.removeClass("active")}),n.on("click",function(e){$(e.target).closest(".block-active").length||e.ctrlKey||e.shiftKey||t.$apply(function(){a.toggleActive(o)})})}}}]);var module=angular.module("ev-fdm");module.directive("clearable",[function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,r){var a=angular.element('<button class="clear" ng-click="clear()">Ã—</button>');t.after(a),a.on("click",function(){e.$apply(function(){t.val(""),r.$setViewValue("")})}),e.$watch(function(){return r.$isEmpty(r.$viewValue)},function(e){e?a.hide():a.show()})}}}]),angular.module("ev-fdm").directive("evDatepicker",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,r){var a="false"!==n.futurAllowed,i=n.dateFormat||"dd/mm/yy";$(function(){t.datepicker({dateFormat:i,maxDate:a?null:0,onSelect:function(t){r.$setViewValue(t),e.$apply()}})})}}}),angular.module("ev-fdm").directive("download",["$http","$location","$document","DownloadService",function(e,t,n,r){return{link:function(t,n,a){n.on("click",function(){e.get(a.download).success(function(e){r.download(e.url)})})}}}]),angular.module("ev-fdm").directive("evEditSection",["NotificationsService",function(e){return{restrict:"AE",transclude:!0,scope:{options:"=",args:"=?",title:"@",headerTitle:"@",noteditable:"=?",notdeletable:"=?"},templateUrl:"ev-edit-section.html",link:function(t,n,r,a,i){function o(e){s.edit=e,t.edit=e,s.editform=t.editform}var s={},l=t.options,c=!1;t.changeToEditMode=function(){(!l.onEdit||l.onEdit&&l.onEdit.apply(null,t.args||[])!==!1)&&o(!0)},t.save=function(){if(!t.editform.$valid)return void(c=!0);var n=!l.onSave||l.onSave&&l.onSave.apply(null,t.args||[]);n&&n.then?(t.inProgress=!0,n.then(function(){e.addSuccess({text:l.successMessage||r.successMessage}),l.success&&l.success(),t.inProgress=!1,o(!1)},function(){t.inProgress=!1,e.addError({text:l.errorMessage||r.errorMessage})})):n!==!1&&o(!1)},t.cancel=function(){(!l.onCancel||l.onCancel&&l.onCancel.apply(null,t.args||[])!==!1)&&o(!1)},t.delete=l.onDelete&&function(){var n=l.onDelete&&l.onDelete.apply(null,t.args||[]);n&&n.then&&(t.inProgress=!0,n.then(function(){e.addSuccess({text:r.successDeleteMessage}),l.success&&l.success(),t.inProgress=!1,o(!1)},function(){t.inProgress=!1,e.addError({text:r.errorDeleteMessage})}))},i(function(e,a){a.edit=t.edit=!!r.edit,a.showErrorMessage=function(e,n){var r=t.editform[e];return(c||r.$dirty)&&(n?r.$error[n]:r.$invalid)},s=a,n.find(".transclude").append(e)})}}}]),angular.module("ev-fdm").directive("ngEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.ngEnter)}),t.preventDefault())})}});var module=angular.module("ev-fdm").directive("evErrorMessage",function(){return{restrict:"E",transclude:!0,scope:{input:"=",error:"@"},template:"<li ng-show=\"input['evHasError'] && input.$error[error]\"><div ng-transclude></div></li>"}}),module=angular.module("ev-fdm").directive("evErrors",function(){return{restrict:"E",transclude:!0,replace:!0,template:'<ul class="errors text-danger" ng-transclude></ul>'}});angular.module("ev-fdm").provider("menuManager",[MenuManagerProvider]).directive("evMenu",["menuManager",EvMenuDirective]);var module=angular.module("ev-fdm").directive("evFlag",function(){return{restrict:"E",replace:!0,scope:{lang:"="},template:'<i class="icon icon-flag flag-{{lang}}"></i>'}});angular.module("ev-fdm").directive("focus",[function(){return{link:function(e,t){e.$evalAsync(function(){t[0].focus()})}}}]);var module=angular.module("ev-fdm").directive("evFormGroup",["$parse","$rootScope",function(){return{restrict:"EA",scope:!0,transclude:!0,replace:!0,template:'<div class="form-group" ng-transclude></div>',controller:function(e,t){this.toggleError=t.toggleClass.bind(t,"has-error")}}}]);angular.module("ev-fdm").directive("linkDisabled",function(){return{restrict:"A",link:function(e,t,n){var r=n.ngClick;r&&e.$watch(n.linkDisabled,function(a,i){a?(t.unbind("click"),t.attr("disabled","disabled")):i&&(n.$set("ngClick",r),t.bind("click",function(){e.$apply(n.ngClick)}),t.removeAttr("disabled"))})}}});var module=angular.module("ev-fdm").directive("evLoadingDots",function(){return{restrict:"E",replace:!0,template:'<span class="loading-dots"><span></span><span></span><span></span></span>'}});angular.module("ev-fdm").directive("mouseFollower",["$document",function(e){return{restrict:"A",link:function(t,n){n=angular.element(n),n.css("position","absolute"),n.css("z-index",1500),e.on("mousemove",function(e){n.css({left:e.pageX,top:e.pageY})})}}}]);var module=angular.module("ev-fdm").directive("evPagination",[function(){var e="...";return{restrict:"AE",replace:!0,templateUrl:"ev-pagination.html",scope:{currPage:"=",nbPage:"=",onPageChange:"="},link:function(t){t.paginationButtons=[],t.prevClass="",t.nextClass="",t.currPage=t.currPage||1,t.nbPage=t.nbPage||1,t.generateButtons=function(){var n=0,r=2;for(t.paginationButtons=[],t.paginationButtons.push({value:1,"class":1==t.currPage?"active":""}),t.currPage-r>2&&t.paginationButtons.push({value:e,"class":"disabled"}),n=r;n>0;n--)t.currPage-n>1&&t.paginationButtons.push({value:t.currPage-n});for(1!=t.currPage&&t.currPage!=t.nbPage&&t.paginationButtons.push({value:t.currPage,"class":"active"}),n=1;r>=n;n++)t.currPage+n<t.nbPage&&t.paginationButtons.push({value:t.currPage+n});t.currPage+r<t.nbPage-1&&t.paginationButtons.push({value:e,"class":"disabled"}),t.nbPage>1&&t.paginationButtons.push({value:t.nbPage,"class":t.currPage==t.nbPage?"active":""})},t.previousPage=function(){if(t.currPage>1){var e=t.currPage;t.currPage--,angular.isFunction(t.onPageChange)&&t.onPageChange(t.currPage,e,"previousPage")}},t.changePage=function(n){if(n!=e&&n>=1&&n<=t.nbPage){var r=t.currPage;t.currPage=n,angular.isFunction(t.onPageChange)&&t.onPageChange(n,r)}},t.nextPage=function(){if(t.currPage<t.nbPage){var e=t.currPage;t.currPage++,angular.isFunction(t.onPageChange)&&t.onPageChange(t.currPage,e,"nextPage")}},t.$watch("nbPage + currPage",function(){t.generateButtons()})}}}]);angular.module("ev-fdm").directive("evPictureList",function(){return{restrict:"EA",scope:{pictures:"=",editable:"=",onDelete:"&",onChange:"&",showUpdate:"=",language:"=",colNumber:"=",onPictureDeleted:"&"},templateUrl:"ev-picture-list.html",link:function(e,t,n){e.pictures=e.pictures||[];var r=e.colNumber||2;e.colNumberBootstrap=12/r,n.onDelete||(e.onDelete=function(t){e.pictures.splice(t.index,1),e.onPictureDeleted()},e.onUpdate=function(e){console.log(e)})}}}),function(){"use strict";angular.module("template/popover/popover.html",[]).run(["$templateCache",function(e){e.put("template/popover/popover.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind-html="title" ng-show="title"></h3>\n      <div class="popover-content"ng-bind-html="content"></div>\n  </div>\n</div>\n')}]),angular.module("ev-fdm").directive("popover",["$timeout",function(e){return{restrict:"A",link:function(t,n){var r;n.bind("focus",function(){n.triggerHandler("focus-not-typing")}),n.bind("blur",function(){r&&e.cancel(r),n.triggerHandler("blur-or-typing")}),n.bind("keypress",function(){r&&e.cancel(r),n.triggerHandler("blur-or-typing"),r=e(function(){n.triggerHandler("focus-not-typing")},1e3)})}}}])}(),angular.module("ev-fdm").directive("promise",[function(){function e(e,t){t.removeClass("promise-resolved promise-resolving promise-empty promise-rejected"),t.addClass(e)}return{restrict:"A",replace:!1,controller:["$scope","$attrs","$parse","$element",function(t,n,r,a){var i=r(n.promise),o=n.emptyMessage,s="false"!==n.promiseDefaultStyles;s&&e("promise-default-styles",a),o&&a.append('<div class="promise-empty-message">'+o+"</div>"),t.$watch(function(){return i(t)},function(t){t?(e("promise-resolving",a),t.then(function(t){return o&&angular.isArray(t)&&!t.length?e("promise-resolved promise-empty",a):e("promise-resolved",a),t},function(){e("promise-rejected",a)})):e("promise-resolved",a)})}]}}]),function(){"use strict";angular.module("ev-fdm").directive("evPromiseProgress",[function(){return{restrict:"A",replace:!0,scope:{promise:"=evPromiseProgress"},template:'<div role="progressbar" class="ev-progress" aria-valuemin="0" aria-valuemax="100"aria-valuenow="0"> <div class="ev-progress-overlay"></div> </div> ',link:function(e,t){var n=t.find(angular.element(document.querySelector(".ev-progress-overlay")));n.css({width:"0%"}),e.$watch("promise",function(e){e&&e.then&&(n.css({width:"0%"}),e.then(null,null,function(e){"object"==typeof e&&(e=e.progress),n.css({width:e+"%"})}),e.finally(function(){n.css({width:"100%"})}))})}}}])}(),angular.module("ev-fdm").directive("evResizableColumn",["$window","$rootScope",function(e,t){function n(e,t){var n=e.css(t+"-width").replace("px","");return"none"!==n?n:null}function r(e,t){return(n(e,"min")||0)-t}function a(e,t){return(n(e,"max")||Number.POSITIVE_INFINITY)-t}return{restrict:"A",scope:!1,link:function(n,i){var o=angular.element('<div class="ev-resizable-column-handle"></div>');i.append(o),o.on("mousedown",function(n){var o=n.pageX;document.body.style.cursor="ew-resize",n.stopPropagation();var s=i.next();i.addClass("unselectable"),s.addClass("unselectable");var l=i.outerWidth(),c=s.outerWidth();s.css("min-width",""),i.css("min-width","");var u=Math.min(a(i,l),-r(s,c)),d=Math.max(r(i,l),-a(s,c));s.css("min-width",c),i.css("min-width",l);var f=angular.element('<div class="ev-resizable-helper"></div>');f.css("min-width",c-u),f.css("max-width",c-d),f.width(c),s.append(f);var p=function(e){var t=e.pageX-o;f.width(c-t)},m=function(n){document.body.style.cursor=null;var r=n.pageX-o;r=r>0?Math.min(r,u):Math.max(r,d),i.css("minWidth",l+r),s.css("minWidth",c-r),f.remove(),e.removeEventListener("mouseup",m),e.removeEventListener("mousemove",p),i.removeClass("unselectable"),s.removeClass("unselectable"),t.$broadcast("module-layout-changed")};e.addEventListener("mouseup",m),e.addEventListener("mousemove",p)})}}}]),angular.module("ev-fdm").directive("body",["$rootScope","NotificationsService","$state",function(e,t,n){return{restrict:"E",link:function(r,a){e.$on("$stateChangeStart",function(e,t){var r=n.current.name.indexOf("."),a=-1!=r?n.current.name.substring(0,r):n.current.name;a&&0===t.name.indexOf(a)||$("body").addClass("state-resolving")}),e.$on("$stateChangeSuccess",function(){a.removeClass("state-resolving")}),e.$on("$stateChangeError",function(e,r,a,i,o,s){console.error&&console.error("toState=",r,"toParams=",a,"fromState=",i,"error=",s,"event=",e),$("body").removeClass("state-resolving");var l=r.fallback&&r.fallback.message||"Error";t.addError({text:l}),r&&r.fallback&&r.fallback.state&&n.go(r.fallback.state)})}}}]),angular.module("ev-fdm").provider("evResponsiveViewport",function(){var e={400:"ev-viewport-xs",600:"ev-viewport-sm",900:"ev-viewport-md"};this.$get=function(){return e},this.setXsBreakpoint=function(t){e[t]="ev-viewport-xs"},this.setSmBreakpoint=function(t){e[t]="ev-viewport-sm"},this.setMdBreakpoint=function(t){e[t]="ev-viewport-md"},this.setBreakpoints=function(t){if(3!==t.length)throw new Error("There should be three breakpoints");t.sort(),e[t[0]]="ev-viewport-xs",e[t[1]]="ev-viewport-sm",e[t[2]]="ev-viewport-md"}}).directive("evResponsiveViewport",["evResponsiveViewport",function(e){return{link:function(t,n){var r=function(){var t,r=n.width(),a=!Object.keys(e).some(function(n){return t=e[n],n>r});a&&(t="ev-viewport-lg"),n.hasClass(t)||(Object.keys(e).forEach(function(t){n.removeClass(e[t])}),n.removeClass("ev-viewport-lg"),n.addClass(t))};r(),t.$on("module-layout-changed",r)}}}]),angular.module("ev-fdm").provider("evSelectLanguage",function(){this.$get=function(){return{availableLang:this.availableLang||[],defaultLang:this.defaultLang}},this.setAvailableLang=function(e){this.availableLang=e},this.setDefaultLang=function(e){this.defaultLang=e}}).directive("evSelectLanguage",["evSelectLanguage",function(e){return{template:'<div class="ev-language-tabs"><div class="btn-group"><button class="btn btn-lg" ng-repeat="lang in availableLang"ng-class="{active: selectedLang===lang}"ng-click="$parent.selectedLang=lang"><span class="ev-icons-flags" ng-class="\'icon-\' + lang"></span></button></div></div>',restrict:"AE",scope:{selectedLang:"=lang"},link:function(t){t.availableLang=e.availableLang,t.selectedLang||(t.selectedLang=e.defaultLang)}}}]),angular.module("ev-fdm").directive("selectableSet",[function(){return{restrict:"A",controller:["$scope","$parse","$element","$attrs","$document",function(e,t,n,r,a){function i(e,t){var n,r,a=o(t),i=Math.min(e,t),u=Math.max(e,t);if(angular.forEach(p,function(e){l(e)}),c.isElementSelected(a)){for(r=i;u>=r;r++)n=o(r),l(n);f=t,p.length=0}else for(p.length=0,r=i;u>=r;r++)n=o(r),s(n),p.push(n)}function o(e){return c.selectableElements[e]}function s(e){c.isElementSelected(e)||c.selectedElements.push(e)}function l(e){var t=c.selectedElements.indexOf(e);t>-1&&c.selectedElements.splice(t,1)}var c=this,u=16,d=t(r.selectedElements);this.selectableElements=[],this.selectedElement=[];var f,p=[];e.$watch(function(){return d(e)},function(){c.selectedElements=angular.isArray(d(e))?d(e):[]}),a.on("keydown",function(e){e.keyCode===u&&n.addClass("noselect")}),a.on("keyup",function(e){e.keyCode===u&&n.removeClass("noselect")}),this.toggleSelection=function(e,t){f=t,p.length=0,this.isElementSelected(e)?l(e):s(e)},this.toggleSelectAll=function(){this.selectedElements.length===this.selectableElements.length?this.selectedElements.length=0:angular.forEach(this.selectableElements,function(e){c.isElementSelected(e)||s(e)})},this.shiftedClick=function(e,t){void 0!==typeof f&&i(f,t)},this.registerElement=function(e){this.selectableElements.push(e)},this.unregisterElement=function(e){var t=this.selectableElements.indexOf(e);t>-1&&this.selectableElements.splice(t,1),t=this.selectedElements.indexOf(e),t>-1&&this.selectedElements.splice(t,1)},this.areAllElementSelected=function(){return this.selectedElements.length===this.selectableElements.length&&0!==this.selectedElements.length},this.isElementSelected=function(e){return c.selectedElements.indexOf(e)>-1}}]}}]).directive("selectable",["$parse",function(e){return{restrict:"A",require:["^selectableSet","?ngModel"],link:function(t,n,r,a){function i(e){e.shiftKey?l.shiftedClick(s,t.$index):(e.ctrlKey||angular.element(e.target).is("[type=checkbox]"))&&l.toggleSelection(s,t.$index)}var o=e(r.selectable),s=o(t),l=a[0],c=a[1];l.registerElement(s),t.$on("$destroy",function(){l.unregisterElement(s)}),t.$watch(function(){return l.isElementSelected(s)},function(){t.selected=l.isElementSelected(s),c&&c.$setViewValue(t.selected)}),n.on("click",function(e){t.$apply(function(){i(e)})})}}}]).directive("selectBox",function(){return{restrict:"E",require:"^selectable",replace:!0,controller:["$scope",function(e){e.idRand=String(Math.random())}],template:'<span><input ng-attr-id="{{idRand}}" type="checkbox" class="tick-checkbox" ng-checked="selected"><label ng-attr-for="{{idRand}}"></label></span>'}}).directive("selectAll",function(){return{restrict:"E",require:"^selectableSet",scope:!0,template:'<span><input ng-attr-id="{{idRand}}" type="checkbox" class="tick-checkbox" ng-checked="allSelected" ng-click="toggleSelectAll()"><label ng-attr-for="{{idRand}}"></label></span>',link:function(e,t,n,r){e.idRand=String(Math.random()),e.toggleSelectAll=function(){r.toggleSelectAll()},e.$watchCollection(function(){return r.areAllElementSelected()},function(){e.allSelected=r.areAllElementSelected()})}}}),angular.module("ev-fdm").directive("sortableSet",function(){return{restrict:"A",scope:!1,controller:["$scope","$parse","$element","$attrs",function(e,t,n,r){var a=this;this.reverseSort=!1,this.sortKey="",e.reverseSort=e.reverseSort||!1;var i=t(r.reverseSort),o=i.assign,s=t(r.sortBy),l=s.assign;e.$watch(function(){return i(e)},function(e){a.reverseSort=e}),e.$watch(function(){return s(e)},function(e){a.sortKey=e}),this.sortBy=function(t){t==this.sortKey?this.reverseSort=!this.reverseSort:(this.reverseSort=!1,this.sortKey=t),o&&o(e,this.reverseSort),l&&l(e,this.sortKey),e.$eval(r.sortChange)}}]}}).directive("sortable",function(){return{restrict:"A",scope:!1,require:"^sortableSet",link:function(e,t,n,r){function a(){r.sortKey===i?(t.removeClass("no-sort"),r.reverseSort?t.removeClass("sort-down").addClass("sort-up"):t.removeClass("sort-up").addClass("sort-down")):t.removeClass("sort-up sort-down").addClass("no-sort")}var i=n.sortable;t.addClass("sortable sort"),e.$watch(function(){return r.sortKey},function(){a()}),e.$watch(function(){return r.reverseSort},function(){a()}),t.on("click",function(){e.$apply(function(){r.sortBy(i)})})}}}),angular.module("ev-fdm").directive("evStopEventPropagation",function(){return{restrict:"A",link:function(e,t,n){n.evStopEventPropagation.split(",").forEach(function(e){t.bind(e.trim(),function(e){e.stopPropagation()})})}}});var module=angular.module("ev-fdm").directive("evSubmit",["$parse",function(e){return{restrict:"A",require:"form",controller:function(t,n,r){var a=[];this.$addValidable=function(e){a.push(e)};var i=e(r.evSubmit,null,!0);n.on("submit",function(e){var n=function(){t.form.$valid&&i(t,{$event:e})};a.forEach(function(e){e()}),t.$apply(n)})},link:function(e,t,n,r){e.form=r}}}]);!function(){"use strict";angular.module("ev-fdm").directive("evTab",function(){return{restrict:"E",transclude:!0,scope:{},controller:function(e){var t=e.panes=[];e.select=function(e){angular.forEach(t,function(e){e.selected=!1}),e.selected=!0},this.addPane=function(n){0===t.length&&e.select(n),t.push(n)};var n=function(t){var n;return t.some(function(t){var r=e.isShowed(t);return r&&(n=t),r}),n};this.selectNext=function(){var r=e.selectedIndex(),a=t.slice(r+1);e.select(n(a)||t[r])},this.selectPrevious=function(){var r=e.selectedIndex(),a=t.slice(0,r).reverse();e.select(n(a)||t[r])},e.selectedIndex=function(){for(var e=0;e<t.length;e++){var n=t[e];if(n.selected)return e}},e.isShowed=function(e){return e.alwaysShow||!!e.tabShow}},template:'<div class="tabbable ev-fixed-header"><ul class="nav nav-tabs ev-header"><li ng-repeat="pane in panes | filter:isShowed" ng-class="{active:pane.selected}" tooltip="{{pane.tabTitle}}" tooltip-placement="bottom" tooltip-append-to-body="true"><a href="" ng-click="select(pane); pane.tabClick()"> <span ng-show="pane.tabIcon" class="icon {{pane.tabIcon}}"></span> <span ng-hide="pane.tabIcon">{{pane.tabTitle}}</span></a></li></ul><div class="tab-content ev-body" ng-transclude></div></div>',replace:!0}}).directive("evPane",function(){return{require:"^evTab",restrict:"E",transclude:!0,scope:{tabTitle:"@",tabIcon:"@",tabClick:"&",tabShow:"="},link:function(e,t,n,r,a){e.alwaysShow=!0,angular.isDefined(n.tabShow)&&(e.alwaysShow=!1);var i,o=function(e,n){i=n,n.$selectNext=r.selectNext,n.$selectPrevious=r.selectPrevious;var a=t.find(".transclude");a.children().remove(),a.append(e)};e.$watch("selected",function(e){angular.isDefined(n.tabReset)&&(e?a(o):i&&i.$destroy())}),r.addPane(e),a(o)},template:'<div class="tab-pane" ng-class="{active: selected}"><div class="section transclude"></div></div>',replace:!0}})}(),angular.module("ev-fdm").directive("evTagList",function(){return{restrict:"EA",scope:{elements:"=",trackBy:"=?",displayElement:"=?",editable:"=",className:"@",maxElements:"=",maxAlertMessage:"@",onTagDeleted:"&"},replace:!0,template:'<ul class="list-inline {{ className }}"><li ng-repeat="element in elements track by trackBy(element)" class="ev-animate-tag-list"><span class="label label-default" >{{ displayElement(element) }}<button ng-show="editable" tabIndex="-1" type="button" class="label-btn" ng-click="remove($index)"><span class="icon-bin"></span></button> </span></li><li ng-show="editable && elements.length >= maxElements" class="text-orange no-margin"> {{ maxAlertMessage }}</li></ul>',link:function(e){e.trackBy=e.trackBy||function(e){return e.name},e.displayElement=e.displayElement||function(e){return e.name},e.remove=function(t){e.elements.splice(t,1),e.onTagDeleted()}}}});var module=angular.module("ev-fdm");module.directive("throttle",["$timeout",function(e){return{restrict:"A",require:"ngModel",priority:1,link:function(t,n,r,a){var i=a.$setViewValue,o=angular.copy(a.$viewChangeListeners);a.$viewChangeListeners=[];var s;a.$setViewValue=function(t){var n=a.$modelValue!==t;i.apply(a,[t]),n&&(s&&e.cancel(s),s=e(function(){angular.forEach(o,function(e){try{e()}catch(t){$exceptionHandler(t)}})},600))}}}}]);var module=angular.module("ev-fdm").directive("evValidable",function(){return{restrict:"A",require:["ngModel","^evSubmit","^?evFormGroup"],link:function(e,t,n,r){var a=r[0],i=r[1],o=r[2],s=function(){a.evBlurred=!0},l=function(){a.evChanged=!0},c=function(){a.evHasError=!(a.$valid||!a.evBlurred||!a.evChanged),o&&o.toggleError(a.evHasError)};t.on("blur",function(){e.$evalAsync(function(){s(),c()})}),a.$viewChangeListeners.push(function(){l(),c()}),i.$addValidable(function(){s(),l(),c()})}}});angular.module("ev-fdm").directive("evValue",function(){return{restrict:"E",replace:!0,scope:{value:"=",noValue:"@"},templateUrl:"ev-value.html"}}),angular.module("ev-fdm").factory("confirmBox",["$modal",function(e){return function(t,n,r,a){return e.open({backdrop:"static",templateUrl:"ev-confirm-box.html",controller:["$scope",function(e){e.title=t,e.message=n,e.positive=r,e.negative=a}]}).result}}]),angular.module("ev-fdm").factory("FilterService",["$rootScope","$timeout",FilterServiceFactory]),angular.module("ev-fdm").factory("Select2Configuration",["$timeout",function(e){return function(t,n,r,a,i){var o,s,l=600,c={};if("object"==typeof t){if(c=t,n=c.formatter,r=c.resultModifier,a=c.minimumInputLength,i=c.key,o=c.dataProviderFilter,t=c.dataProvider,l=c.timeout||l,"object"==typeof o){var u=o;o=function(){return u}}else"function"!=typeof o&&(o=function(){return{}});"string"==typeof c.id?s=function(e){return e[c.id]}:"function"==typeof c.id&&(s=c.id)}var d,f="",p={minimumInputLength:angular.isDefined(a)&&angular.isNumber(a)?a:3,allowClear:!0,query:function(n){var a=f===n.term?0:600;f=n.term,d&&e.cancel(d),d=e(function(){t(n.term,n.page,o).then(function(e){var t=[];r&&angular.forEach(e,function(e){t.push(r(e))});var a={results:t.length?t:e};if(e.pagination&&e.pagination.current_page<e.pagination.total_pages&&(a.more=!0),i&&n.term.length){var o={id:null};if(o[i]=n.term,a.results.length){var s=a.results.shift();a.results.unshift(s,o)}else a.results.unshift(o)}n.callback(a)})},a)},formatResult:function(e){return n(e)},formatSelection:function(e){return n(e)},initSelection:function(){return{}},id:s};return p}}]),angular.module("ev-fdm").filter("cleanupDate",function(){return function(e){var t="";if(e){var n=e.slice(0,4),r=e.slice(5,7),a=e.slice(8,10);t=a+"/"+r+"/"+n}return t}}),function(){"use strict";function e(){function e(e){if(!t.call(r,e))throw new Error('Mapping "'+e+'" is not valid, did you register it using mapSymbolFilterProvider#registerMapping() ?')}var r={},a={};this.registerMapping=function(e,n){if(t.call(r,e))throw new Error('A mapping named "'+e+'" was already registered');
var a=r[e]={};for(var i in n)t.call(n,i)&&(a[i]=n[i])},this.registerDefault=function(t,n){e(t),a[t]=n},this.$get=function(){return function(i,o){if(n(o))return t.call(o,i)?o[i]:i;e(o);var s=r[o];switch(!0){case t.call(s,i):return s[i];case t.call(a,o):return a[o];default:return i}}}}var t=Object.prototype.hasOwnProperty,n=angular.isObject;angular.module("ev-fdm").provider("mapFilter",e)}(),angular.module("ev-fdm").filter("prettySecs",[function(){return function(e){var t=parseInt(e,10),n=Math.floor(t/3600),r=Math.floor((t-3600*n)/60),a=t-3600*n-60*r;10>n&&(n="0"+n),10>r&&(r="0"+r),10>a&&(a="0"+a);var i=n+":"+r+":"+a;return i}}]),angular.module("ev-fdm").filter("replace",[function(){return function(e,t,n){return angular.isDefined(e)?e.replace(t,n||""):""}}]),angular.module("ev-fdm").filter("sum",["$parse",function(e){return function(t,n){if(!angular.isDefined(t))return 0;var r=e(n);return t.reduce(function(e,t){var n=r(t);return e+(angular.isDefined(n)&&angular.isNumber(n)?parseFloat(n):0)},0)}}]),angular.module("ev-fdm").filter("textSelect",[function(){return function(e,t){return t[e]?t[e]:e}}]),angular.module("ev-fdm").filter("unsafe",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),angular.module("ev-fdm").service("DownloadService",["$window","$document",function(e,t){var n=null;return{download:function(r,a){if(n||(n=t[0].createElement("iframe"),n.style.display="none",t[0].body.appendChild(n)),a){var i=e.location.protocol+"//"+e.location.host;r=i+r}n.src=r}}}]),angular.module("ev-fdm").service("FilteringService",["$location",function(){var e={};return{setSelectedFilter:function(t,n){e[t]=void 0!=n&&"undefined"!=n?n:""},getSelectedFilter:function(t){var n="";return"undefined"!=typeof e[t]&&"undefined"!=e[t]&&(n=e[t]),n},getAllFilters:function(){return e}}}]);var module=angular.module("ev-fdm"),ModalService=function(e,t,n,r){this.$rootScope=e,this.$templateCache=t,this.$compile=n,this.$controller=r};ModalService.prototype.open=function(e){e=this._readOptions(e);var t=(e.parentScope||this.$rootScope).$new();t=_(t).extend(e.scope);var n;e.controller&&(n=this.$controller(e.controller,{$scope:t}));var r=this.$compile(e.template||this.$templateCache.get(e.templateUrl))(t);return r.$scope=t,r.$controller=n,n&&(n.$modal=r),$(r).modal(e)},ModalService.prototype._readOptions=function(e){if(e=_({backdrop:!0,scope:{},keyboard:!0}).extend(e),!e.templateUrl&&!e.template)throw new Error("Either template or templateUrl have to be defined");return e},module.service("ModalService",["$rootScope","$templateCache","$compile","$controller",ModalService]);var module=angular.module("ev-fdm");module.service("NotificationsService",["$timeout",function(e){function t(e){e.type||(e.type=c.SUCCESS),a(e)}function n(e){s=_(s).without(e),r()}function r(){if(s.length){var t=s[0];o.activeNotification!==t&&(o.activeNotification=t,-1!==t.delay&&e(function(){n(t)},1e3*(t.delay||l)))}else o.activeNotification=null}function a(e){s.push(e),r()}function i(e){return angular.isObject(e)?e:{text:e}}var o=this,s=[],l=5,c={SUCCESS:0,ERROR:1,INFO:2,WARNING:3};this.activeNotification=null,this.add=t,this.remove=n,this.addError=function(e){e=i(e),e.type=c.ERROR,t(e)},this.addSuccess=function(e){e=i(e),e.type=c.SUCCESS,t(e)},this.type=c}]);const DEFAULT_CONTAINER_ID="ev-default-panels-container",MAX_VISIBLE_PANEL=3;angular.module("ev-fdm").service("PanelService",["$animate","$q","$http","$templateCache","$compile","$rootScope","$timeout","$window",function(e,t,n,r,a,i,o,s){function l(e,t){var n=null,r=Object.keys(p[t]).map(function(e){return p[t][e]});return r.filter(function(e){return e.element.parent().length}).filter(function(e){return e.index}).some(function(t){var r=t.index>e;return r&&(n=t),!r}),(n||r[0]).element}function c(e){return e.template||e.templateURL?t.when(e.template):n.get(e.templateUrl,{cache:r}).then(function(e){return e.data})}function u(e){if(!e)return Object.keys(f).map(function(e){u(e)}),this;var t=f[e],n=$.makeArray(angular.element(t).children(".ev-panel"));d(n,t)}function d(e,t){e.forEach(function(e){angular.element(e).removeClass("ev-stacked"),angular.element(e).css("minWidth",""),angular.element(e).css("maxWidth","")}),e.length>MAX_VISIBLE_PANEL&&e.slice(0,-3).forEach(function(e){angular.element(e).addClass("ev-stacked")});for(var n=e.slice(0,-3).length;t[0].offsetWidth<t[0].scrollWidth&&n<e.length-1;)angular.element(e[n]).addClass("ev-stacked"),n++;var r=angular.element(e[n]);r.css("minWidth",r.width()-t[0].scrollWidth+t[0].offsetWidth),r.css("maxWidth",t[0].offsetWidth),i.$broadcast("module-layout-changed")}var f={},p={},m=function(t,n){var r=f[n];if(r&&!t.element.parent().length)if(t.index&&r.children().length){var a=l(t.index,n);e.move(t.element,r,a.element,function(){u(n)})}else e.move(t.element,r,null,function(){u(n)})};this.open=function(e,t){t||(t=DEFAULT_CONTAINER_ID);var n=p[t]=p[t]||{};if(!e.name&&e.panelName&&(console.log("Deprecated: use name instead of panelName"),e.name=e.panelName),!e)return void console.log("A panel must have a name (options.name)");var r=e.name.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();if(n[r])return n[r];var o=angular.element('<div class="container-fluid ev-panel ev-panel-'+r+'" ev-responsive-viewport ev-resizable-column></div>'),s=c(e);return n[r]=e,e.element=o,s.then(function(n){var r=i.$new();return o.html(n),o=a(o)(r),e.element=o,e.scope=r,m(e,t),e})},this.getPanels=function(e){return e||(e=DEFAULT_CONTAINER_ID),p[e]},this.close=function(t,n){t=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),n||(n=DEFAULT_CONTAINER_ID);var r=p[n];t&&r[t]||console.log("Panel not found for: "+t+" in container: "+n);var a=r[t].element;e.leave(a,function(){u(n),r[t].scope.$destroy(),delete r[t]})},this.registerContainer=function(e,t){if(t||(t=DEFAULT_CONTAINER_ID),!f[t]){if(f[t]=e,!p[t])return;Object.keys(p[t]).forEach(function(e){var n=p[t][e];m(n,t)})}};var v=null;return angular.element(s).on("resize",function(){null!==v&&o.cancel(v),v=o(function(){u()},200)}),this}]).directive("evPanels",["PanelService",function(e){return{restrict:"AE",scope:{},replace:!0,template:'<div class="ev-panels-container"></div>',link:function(t,n,r){e.registerContainer(n,r.id)}}}]);var module=angular.module("ev-fdm");module.service("SortService",[function(){var e="",t=!1,n=function(){return e},r=function(n){return n==e?t=!t:e=n,this},a=function(n){var r="sort ";return r+=n==e?t?"sort-up":"sort-down":"no-sort"},i=function(e){t=e},t=function(){return t};return{sortBy:r,getSortCSS:a,getCurrentSort:n,setReverse:i,isReverse:t}}]);var module=angular.module("ev-fdm");module.service("UtilService",[function(){this.generatedIds={},this.generateId=function(e){var t=e+1e4*Math.random();return this.generatedIds[t]=!0,t}}]),angular.module("ev-fdm").factory("RestangularStorage",["$rootScope","$q","Restangular",function(e,t,n){function r(t,r){this.restangular=n,this.resourceName=t,this.defaultEmbed=r||[],this.emitEventCallbackCreator=function(t,n){return function(r){return e.$broadcast(this.resourceName+"::"+t,n),r}.bind(this)}.bind(this)}return r.buildSortBy=function(e,t){var n=t?"DESC":"ASC";return e+":"+n},r.buildEmbed=function(e){return e.join(",")},r.buildParameters=function(e,t){var n={};return angular.isArray(t)&&t.length?n.embed=r.buildEmbed(t.concat(e.defaultEmbed)):e.defaultEmbed.length&&(n.embed=r.buildEmbed(e.defaultEmbed)),n},r.buildFilters=function(e){var t={};return angular.forEach(e,function(e,n){angular.isObject(e)&&angular.isDefined(e.uuid)?t[n+".uuid"]=e.uuid:angular.isObject(e)&&angular.isDefined(e.id)?t[n+".id"]=e.id:angular.isArray(e)&&e.length>0?t[n]=e.join(","):angular.isDate(e)?t[n]=e.toISOString():angular.isDefined(e)&&""!==e&&null!==e&&(t[n]=e)}),t},r.updateObjectFromResult=function(e,t){!function r(e,t,n){n&&n.forEach(function(n){n in t&&(e[n]&&e[n].data?"object"!=typeof t[n].data||Array.isArray(t[n].data)?e[n].data=t[n].data:r(e[n].data,t[n].data,t[n].embeds):e[n]=t[n],delete t[n])}),angular.extend(e,t)}(e.data&&e.embeds?e.data:e,angular.copy(n.stripRestangular(t)),t.embeds)},r.prototype.updateObjectFromResult=r.updateObjectFromResult,r.updateObjectBeforePatch=function(e,t){!function n(e,t,r){t&&t.forEach(function(t){t in r&&(e[t]&&e[t].data?"object"!=typeof r[t].data||Array.isArray(r[t].data)?e[t].data=r[t].data:n(e[t].data,e[t].embeds,r[t].data):e[t]=r[t],delete r[t])}),angular.extend(e,r)}(e,e.embeds,angular.copy(t))},r.prototype.getAll=function(e){var t={};if(e=e||{},angular.isNumber(e.page)&&e.page>0&&(t.page=e.page),angular.isNumber(e.number)&&e.number>0&&(t.number=e.number),angular.isArray(e.embed)&&e.embed.length?t.embed=r.buildEmbed(e.embed.concat(this.defaultEmbed)):this.defaultEmbed.length&&(t.embed=r.buildEmbed(this.defaultEmbed)),e.sortKey&&(t.sortBy=r.buildSortBy(e.sortKey,e.reverseSort)),e.filters){var n=r.buildFilters(e.filters);angular.extend(t,n)}return this.restangular.all(this.resourceName).getList(t)},r.prototype.getFirst=function(e,t,n,r){return this.getAll.call(this,{number:1,page:null,embed:e,filters:t,sortKey:n,reverseSort:r}).then(function(e){return e[0]})},r.prototype.getList=function(e,t,n,r,a){return this.getAll.call(this,{page:e,embed:t,filters:n,sortKey:r,reverseSort:a})},r.prototype.getById=function(e,t){return this.restangular.one(this.resourceName,e).get(r.buildParameters(this,t))},r.prototype.update=function(e,t,a){return e.put||n.restangularizeElement(null,e,this.resourceName),e.put(r.buildParameters(this,t)).then(function(t){return a&&a.preventObjectUpdate||r.updateObjectFromResult(e,t),t}).then(this.emitEventCallbackCreator("updated",[e]))},r.prototype.updateAll=function(e,n,a){var i=r.buildParameters(this,n);return t.all(e.map(function(e){return e.put(i).then(function(t){return a&&a.preventObjectUpdate||r.updateObjectFromResult(e,t),t})})).then(this.emitEventCallbackCreator("updated",e))},r.prototype.patch=function(e,t,a,i){return e.patch||n.restangularizeElement(null,e,this.resourceName),r.updateObjectBeforePatch(e,t),e.patch(t,r.buildParameters(this,a)).then(function(t){return i&&i.preventObjectUpdate||r.updateObjectFromResult(e,t),t}).then(this.emitEventCallbackCreator("updated",[e]))},r.prototype.patchAll=function(e,n,a,i){e.forEach(function(e){r.updateObjectBeforePatch(e,n)});var o=r.buildParameters(this,a);return t.all(e.map(function(e){return e.patch(n,o).then(function(t){return i&&i.preventObjectUpdate||r.updateObjectFromResult(e,t),r.updateObjectFromResult(e,t),t})})).then(this.emitEventCallbackCreator("updated",e))},r.prototype.create=function(e,t,n){return this.restangular.all(this.resourceName).post(e,r.buildParameters(this,t)).then(function(t){return n&&n.preventObjectUpdate||r.updateObjectFromResult(e,t),t}).then(this.emitEventCallbackCreator("created",[e]))},r.prototype.delete=function(e){return e.delete||n.restangularizeElement(null,e,this.resourceName),e.remove().then(this.emitEventCallbackCreator("deleted",[e]))},r.prototype.deleteAll=function(e){return t.all(e.map(function(e){return e.remove()})).then(this.emitEventCallbackCreator("deleted",e))},r.prototype.save=function(e,t,a){return e.save||n.restangularizeElement(null,e,this.resourceName),e.save(r.buildParameters(this,t)).then(function(t){return a&&a.preventObjectUpdate||r.updateObjectFromResult(e,t),t}).then(this.emitEventCallbackCreator("updated",[e]))},r.prototype.saveAll=function(e,n,a){var i=r.buildParameters(this,n);return t.all(e.map(function(e){return e.save(i).then(function(t){return a&&a.preventObjectUpdate||r.updateObjectFromResult(e,t),t})})).then(this.emitEventCallbackCreator("updated",e))},r.prototype.getNew=function(){return this.restangular.one(this.resourceName)},r.prototype.copy=function(e){return this.restangular.copy(e)},r}]),angular.module("ev-fdm").directive("disableValidation",function(){return{require:"^form",restrict:"A",link:function(e,t,n,r){var a;e.$watch(n.disableValidation,function(e){a||(a=r[t.attr("name")]),e===!1?(r.$addControl(a),angular.forEach(a.$error,function(e,t){r.$setValidity(t,!e,a)})):r.$removeControl(a)})}}}),angular.module("ev-fdm").directive("strictMin",function(){return{require:"ngModel",link:function(e,t,n,r){function a(e){var t=parseFloat(e),a=parseFloat(n.strictMin);return t>a?(r.$setValidity("strictMin",!0),e):void r.$setValidity("strictMin",!1)}r.$parsers.unshift(a),r.$formatters.push(a)}}});

angular.module("ev-leaflet",["leaflet-directive"]).provider("evLeaflet",function(){this.$get=function(){return{icons:this.icons}},this.setIcons=function(e){this.icons=e}}).directive("evLeaflet",["leafletData","evLeaflet","$log",function(e,a,t){return{template:'<leaflet class="ev-leaflet" defaults="defaults" markers="markers" center="center"></leaflet>',restrict:"AE",scope:{coordinates:"=",defaultCoordinates:"=?",editable:"="},controller:function(e){function r(){e.center?(e.center.lat=e.markers.marker.lat,e.center.lng=e.markers.marker.lng):e.center={lat:e.markers.marker.lat,lng:e.markers.marker.lng,zoom:8}}var l={iconSize:[40,40],shadowSize:[1,1],iconAnchor:[1,20]},n=a.icons;"default"in n&&angular.extend(angular.copy(l),n.default),"draggable"in n&&angular.extend(angular.copy(l),n.draggable),e.defaults={scrollWheelZoom:!1,doubleClickZoom:!1},e.markers={marker:{focus:!0}},e.$watch("coordinates.latitude",function(a){(isNaN(a)||null==a)&&(a=e.defaultCoordinates&&null!=e.defaultCoordinates.latitude?e.defaultCoordinates.latitude:0,t.warn("ev-leaflet: latitude is not a number")),e.markers.marker.lat=a,r()}),e.$watch("coordinates.longitude",function(a){(isNaN(a)||null==a)&&(a=e.defaultCoordinates&&null!=e.defaultCoordinates.longitude?e.defaultCoordinates.longitude:0,t.warn("ev-leaflet: longitude is not a number")),e.markers.marker.lng=a,r()}),r(),e.$watch("markers.marker.lat",function(a){null!=a&&e.editable&&(e.coordinates.latitude=a)}),e.$watch("markers.marker.lng",function(a){null!=a&&e.editable&&(e.coordinates.longitude=a)}),e.$watch("editable",function(){var a=e.editable;e.markers.marker.icon=a?n.draggable:n["default"],e.markers.marker.draggable=a})}}}]);

!function(e){var t={menubar:!1,statusbar:!1,toolbar:"bold italic underline | alignleft aligncenter alignright | bullist",skin:!1,verify_html:!0,convert_fonts_to_spans:!0,inline:!0,browser_spellcheck:!0};angular.module("ev-tinymce",[]).provider("evTinymce",function(){var e={};this.register=function(t,n){if(e.hasOwnProperty(t))throw new Error('A config named "'+t+'" was already registered');e[t]=n},this.get=function(t){return e[t]},this.$get=function(){return e}}).directive("evTinymce",["$timeout","evTinymce",function(n,i){var o=0;return{template:'<div class="tiny-mce-wrapper form-control"><div class="ev-placeholder-container"></div><div class="ev-tinymce-content"></div><div ng-click="focusTinymce()" class="ev-tinymce-toolbar"></div><div class="max-chars-info"></div></div>',restrict:"AE",replace:!0,require:"?ngModel",scope:{tinymceOptions:"="},link:function(a,r,c,l){var s="uiTinymce"+o++,d=r.find(".ev-tinymce-content");d.attr("id",s),r.find(".ev-tinymce-toolbar").attr("id",s+"toolbar");var u,m=function(){return u||(u=e.get(s)),u},v=angular.extend({fixed_toolbar_container:"#"+s+"toolbar"},t,i[c.configKey],a.tinymceOptions),f=v.maxChars=c.maxChars||v.maxChars||null,g=85,h=function(e,t){var n=r.parent().find(".max-chars-info");n.text(e+" / "+t);var i=e/t*100>g,o=e>=t;n.toggleClass("max-chars-warning",i),n.toggleClass("max-chars-reached",o)},p=!1,y=!1,b="",x="",C=function(){var e=m();tinymce.DOM.addClass(d,"placeholder-light"),e.setContent(c.placeholder)},T=function(e){var t=m();p?x===c.placeholder&&(t.setContent(""),t.selection.setCursorLocation(),tinymce.DOM.removeClass(d,"placeholder-light")):e!==c.placeholder&&C()},w=function(){var e=m(),t=d.html(),i=d.text(),o=f&&i.length>f,a=f&&x.length>f;if(y&&i===c.placeholder)b=t,x=i;else if(!o||!a&&x.length)a&&o?e.setContent(b):(n(function(){l.$setViewValue(""===i||i===c.placeholder?"":t)}),b=t,x=i);else{var r=i.substr(0,f);e.setContent(r,{format:"text"})}f&&h(x.length,f),y=""===i||i===c.placeholder,y&&c.placeholder&&T(i)};l.$render=function(){var e=m();e&&(l.$viewValue?e.setContent(l.$viewValue):c.placeholder&&(y=!0,C()))},a.focusTinymce=function(){var e=m();e&&e.focus()};var A=function(e){e.on("init",function(){l.$viewValue&&l.$render()}),e.on("ExecCommand",function(){w()}),e.on("KeyUp",function(){w()}),e.on("SetContent",function(e){e.initial||w()}),e.on("blur",function(){p&&(p=!1,w()),d.blur()}),e.on("focus",function(){p||(p=!0,w())})};v.setup=A,v.elems=s,v.mode="exact",e.init(v),a.$on("$destroy",function(){var e=m();e&&e.destroy()}),e.execCommand("mceToggleEditor",!1,s)}}}])}(window.tinyMCE),tinymce.PluginManager.add("evelements",function(e){function t(t){return function(){var n=e.dom,i=e.selection.getNode();i&&t.matches(i)?n.remove(i,!0):e.insertContent(n.createHTML(t.name,{},n.encode(e.selection.getContent({format:"text"}))))}}function n(t){return function(){var n=e.dom,i=e.selection.getNode(),a=null;if(i&&t.matches(i)){a={};for(var r=n.getAttribs(i),c=0;c<r.length;++c){var l=r[c];a[l.name]=l.value}}else i=null;var s=t.key||t.name,d=o[s]&&o[s].callback,u=i?"innerText"in i?i.innerText:i.textContent:e.selection.getContent({format:"text"});(d||t.callback)(a,function(o,a){if(i){if(e.focus(),!o&&!a)return n.remove(i,!0),void e.undoManager.add();n.removeAllAttribs(i),n.setAttribs(i,o),a&&("innerText"in i?i.innerText=a:i.textContent=a),e.selection.select(i),e.undoManager.add()}else e.focus(),i=n.createHTML(t.name,o,a&&n.encode(a)),e.selection.setContent(i),e.undoManager.add()},u,o)}}var i=e.settings.evelements,o=e.settings.evelementsOptions;"string"==typeof i&&(i=i.split(" ")),i.forEach(function(i){"string"==typeof i&&(i={name:i}),i.matches=i.matches||function(e){return e.nodeName.toLowerCase()===i.name};var o=i.callback?n(i):t(i);e.addButton("ev"+(i.key||i.name),{text:void 0!==i.title?i.title:i.name,icon:i.icon,tooltip:i.tooltip||"Set this text as "+i.name,shortcut:i.shortcut,onclick:o,stateSelector:i.selector||i.name}),i.shortcut&&e.addShortcut(i.shortcut,"",o)})}),tinymce.PluginManager.add("evimage",function(e){function t(){var t=e.dom,n=e.selection.getNode(),i=null;n&&n.getAttribute("data-picture-id")&&(i={src:t.getAttrib(n,"src"),alt:t.getAttrib(n,"alt"),"class":t.getAttrib(n,"class"),"data-picture-id":t.getAttrib(n,"data-picture-id")}),e.settings.evimage(i,function(o){i?(t.removeAllAttribs(n),t.setAttribs(n,o)):e.selection.setContent(e.dom.createHTML("img",o))})}console.log("evimage is deprecated: use evelements"),e.addButton("evimage",{icon:"image",tooltip:"Insert/edit image",onclick:t,stateSelector:"img[data-picture-id]:not([data-mce-object],[data-mce-placeholder])"}),e.addMenuItem("evimage",{icon:"image",text:"Insert image",onclick:t,context:"insert",prependToContext:!0}),e.addCommand("mceImage",t)});

!function(){"use strict";angular.module("ev-upload",["ev-fdm"])}(),function(){"use strict";angular.module("ev-upload").directive("evPictureButtonUpload",["NotificationsService","$http",function(e){return{restrict:"AE",scope:{pictures:"=",buttonText:"@",tooltipText:"@",iconName:"@",url:"@",language:"=",maxFiles:"@",addPicture:"&",onPictureAdded:"&"},template:'<ev-upload settings="settings" file-success="addPicture({picture: file})"upload="newUpload(promise)"><div ng-hide="uploading"><button type="button" tabIndex="-1" class="btn btn-tertiary btn-env ev-upload-clickable"tooltip="{{tooltipText}}"tooltip-placement="top"><span class="icon {{iconName}}"></span> {{buttonText}}</button></div><div class="ev-picture-uploading" ng-show="uploading"><div class="ev-picture-upload-label"> {{"Transfert en cours"| i18n}} </div><p> {{upload.done}} / {{upload.total}} </p></div><div ng-show="uploading" ev-promise-progress="uploadPromise"></div></ev-upload>',link:function(t,n,l){t.uploading=!1,t.settings={acceptedFiles:"image/*",url:t.url,maxFiles:t.maxFiles||100},t.pictures=t.pictures||[],t.$watch("url",function(e){t.settings.url=e}),t.newUpload=function(n){t.upload={done:0,total:"?"},t.uploading=!0,t.uploadPromise=n,n.then(function(){e.addSuccess({text:"Les images ont Ã©tÃ© transfÃ©rÃ©es avec succÃ¨s"})},function(){e.add({type:e.type.WARNING,text:"Certaines images n'ont pas pu Ãªtre transfÃ©rÃ©es."})},function(e){t.upload=e}).finally(function(){t.uploading=!1})},l.addPicture||(t.addPicture=function(e){e=e.picture;var n=e.data[0];t.language&&(Array.isArray(n.legend)&&(n.legend={}),n.legend[t.language]||(n.legend[t.language]={name:""})),t.pictures.unshift(n),t.onPictureAdded()})}}}])}(),function(){"use strict";angular.module("ev-upload").directive("evPictureUpload",["NotificationsService","$http",function(e,t){return{restrict:"AE",scope:{addPicture:"=",url:"@",language:"="},template:'<ev-upload settings="settings" file-success="pictureUploaded(file)"class="ev-picture-upload" upload="newUpload(promise)"><div ng-hide="uploading"><div class="ev-picture-upload-label">{{ "Faites glisser vos images ici" | i18n }}</div><table style="width:100%"><tr><td style="width:114px"><button type="button" tabIndex="-1" class="btn ev-upload-clickable">{{ "Importer..." | i18n}}</button></td><td style="width:30pxÂ´; line-height: 36px;">{{ "ou" | i18n }}</td><td><ng-form novalidate name="flickr" ng-class="{\'has-error\': flickr.$dirty && flickr.$invalid}"><input name="fUrl" placeholder="{{\'Lien Flickr\' | i18n}}" ng-model="$parent.flickrUrl" ng-pattern="flickrUrlPattern" class="form-control" ng-change="uploadFlickrUrl(flickr)"/><div ng-show="flickr.fUrl.$dirty && flickr.fUrl.$invalid"><p class="control-label" for="fUrl" data-ng-show="flickr.fUrl.$error.pattern">{{ "L\'url doit Ãªtre une photo flickr" | i18n}}</p></div></ng-form></td></tr></table></div><div class="ev-picture-uploading" ng-show="uploading"><div class="ev-picture-upload-label"> {{"Upload en cours"| i18n}} </div><div class="spinner"></div><p> {{upload.done}} / {{upload.total}} {{ "photo(s) uploadÃ©e(s)" | i18n }} </p></div><div ng-show="uploading" ev-promise-progress="uploadPromise"></div></ev-upload>',link:function(e){e.flickrUrlPattern=/^(https\:\/\/)?www\.flickr\.com\/photos\/.*\/\d+.*$/,e.settings={acceptedFiles:"image/*",url:e.url}},controller:function(n){n.uploading=!1,n.$watch("url",function(e){n.settings.url=e}),n.uploadFlickrUrl=function(e){if(e.$valid&&n.flickrUrl){var l=/(https\:\/\/)?www\.flickr\.com\/photos\/.*\/\d+/.exec(n.flickrUrl)[0],i=t.post(n.url,{"flickr-url":l});i.success(function(e){var t=e.data[0];n.addPicture(t)}).success(function(){e.$setPristine(),n.flickrUrl=""}),n.newUpload(i),n.upload={done:0,total:1,progress:0}}},n.newUpload=function(t){n.upload=null,n.uploading=!0,n.uploadPromise=t,t.then(function(){e.addSuccess({text:"Les images ont Ã©tÃ© uploadÃ©es avec succÃ¨s"})},function(){e.add({type:e.type.WARNING,text:"Certaines images n'ont pas pu Ãªtre uploadÃ©es."})},function(e){n.upload=e}).finally(function(){n.uploading=!1})},n.pictureUploaded=function(e){var t=e.data[0];n.addPicture(t)}}}}])}(),function(e){"use strict";angular.module("ev-upload").directive("evUpload",["$log","$q","$timeout",function(t,n,l){var i={previewTemplate:!1,previewsContainer:!1,autoQueue:!0,maxFilesize:12,maxFiles:100,uploadMultiple:!1,parallelUploads:3};return{transclude:!0,restrict:"EA",replace:!0,scope:{settings:"=",uploadStart:"&upload",fileSuccess:"&",fileAdded:"&"},template:'<div class="ev-upload"><div ng-transclude> </div></div>',link:function(o,r){function a(e){return s.getAcceptedFiles().reduce(function(t,n){return t+n.upload[e]},0)}function d(){var e=r.find(".ev-upload-dropzone");return 0===e.length&&(e=r),e.addClass("dz-default"),e.addClass("dz-message"),e[0]}function u(){return r.find(".ev-upload-clickable")[0]}function c(t){p={done:0,progress:0};var i=function(){p.progress=100*a("bytesSent")/a("total"),p.total=s.getAcceptedFiles().length,o.deferred.notify(p)};s.off("uploadprogress",i).off("maxfilesexceeded");var o={deferred:n.defer(),hasFileErrored:!1};i(),s.once("error",function(){o.hasFileErrored=!0}),s.on("uploadprogress",i);var r=function(){return!s.files.filter(function(t){return t.status===e.QUEUED||t.status===e.ADDED||t.status===e.UPLOADING}).length},d=function(){t.$apply(function(){l(function(){r()&&(s.off("complete",d),l(function(){o.hasFileErrored?o.deferred.reject("filehaserrored"):o.deferred.resolve()}))})})};s.on("maxfilesexceeded",function(){o.deferred.reject("maxfilesexceeded")}),s.on("complete",d),t.currentUpload=o.deferred.promise,t.uploadStart({promise:o.deferred.promise}),t.currentUpload.finally(function(){s.removeAllFiles(!0),t.currentUpload=null})}o.fileSuccess=o.fileSuccess||function(){},o.fileAdded=o.fileAdded||function(){};var s=null,p=null,f={};o.$watch("settings",function(l){return l.url?(null!==s&&s.destroy(),l=angular.extend(i,l),s=new e(d(),angular.extend({clickable:u()},l)),o.currentUpload=null,s.on("addedfile",function(e){null===o.currentUpload&&o.$apply(c);var t=n.defer();f[e.name]=t;var l=function(){s.removeFile(e)};o.$apply(function(n){n.fileAdded({dropzoneFile:e,promise:t.promise,cancel:l})})}),s.on("uploadprogress",function(e,t){o.$apply(function(){f[e.name].notify(t)})}),s.on("success",function(e,t){o.$apply(function(n){f[e.name].resolve({file:t}),n.fileSuccess({file:t})})}),s.on("error",function(e,t,n){t||500!==n.status||(t=l.dictResponseError||"Unexpected error during the upload"),"Upload canceled."===t&&(t=l.dictCanceledUpload||"The upload has been canceled"),o.$apply(function(){f[e.name].reject(t)})}),s.on("canceled",function(e){var t=f[e.name];o.$apply(function(){t.reject(l.dictCanceledUpload||"The upload has been canceled")})}),void s.on("complete",function(){angular.isDefined(p)&&(p.done+=1)})):void t.warn("No url provided to the upload zone")},!0),o.$on("$destroy",function(){s.destroy()})}}}])}(Dropzone);

//# sourceMappingURL=ev-fdm.min.js.map