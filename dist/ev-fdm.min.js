function FilterServiceFactory(e,t){function n(){this.filters={};var n=[],a=this;e.$watch(function(){return a.filters},function(e,n){n!==e&&t(function(){a.modifier?a.modifier.call(a,e,n):a.callListeners()},0)},!0),this.setModifier=function(e){angular.isFunction(e)&&(this.modifier=e)},this.addListener=function(e,t){angular.isFunction(t)&&(n.push(t),e.$on("$destroy",function(){a.removeListener(t)}))},this.removeListener=function(e){angular.forEach(n,function(t,a){t===e&&n.splice(a,1)})},this.callListeners=function(){var e=this;angular.forEach(n,function(t){t(e.filters)})}}return new n}function MenuManagerProvider(){function e(e){var t=null;return angular.forEach(n.tabs,function(n){e===n.state&&(t=n)}),t}function t(t){t=t||{},t=e(t.state),t&&(n.activeTab&&(n.lastTab=n.activeTab,n.activeTab.active=!1),t.active=!0,n.activeTab=t)}var n=this;this.tabs=[],this.activeTab=null,this.lastTab=null,this.addTab=function(e){return this.tabs.push(e),this},this.$get=["$rootScope","$state",function(a){return a.$on("$stateChangeStart",function(n,a,r,i){if(""===i.name){var o=e(a.name);o&&t(o)}}),a.$on("$stateChangeError",function(){t(n.lastTab)}),{tabs:n.tabs,selectTab:t}}]}function EvMenuDirective(e){return{restrict:"E",replace:!0,template:'<ul class="lisette-module-tabs nav nav-tabs" ng-cloak><li ng-repeat="tab in tabs" ng-class="{active: tab.active}"><a ng-click="selectTab(tab)">{{ tab.name }}</a></li></ul>',controller:["$scope","$state","$rootScope",function(t,n,a){t.tabs=e.tabs,a["evmenu-state"]&&e.selectTab(a["evmenu-state"]),t.selectTab=function(t){e.selectTab(t),n.go(t.state)}}]}}function AjaxStorage(e,t,n,a){function r(n){if(n.cache){var r=JSON.stringify(n),o=i.get(r);if(o)return o}n.id=Fanny.Utils.generateId("proxy:request:");var l={url:"/backoffice/common/xhr",method:"POST",responseType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:n},c=e(l).then(function(e){return e.data.success?e.data.result[n.id].data:(a.warn(e.data.error,e.data.errors),e.data.result[n.id].authenticated===!1&&(window.location.href="/login?expired=1"),t.reject(e.data.result[n.id]))});return n.cache&&i.put(r,c),c}var i=n("customHttpCache");return{launchRequest:r}}function Storage(e){return{get:function(t){return e.launchRequest(t)}}}angular.module("ev-fdm",["ui.router","ui.date","chieffancypants.loadingBar","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.select2","angularMoment","ngAnimate","checklist-model","ui.bootstrap","restangular"]).config(["cfpLoadingBarProvider",function(e){e.includeSpinner=!1,e.parentSelector="#lisette-menu"}]).config(["$tooltipProvider",function(e){e.options({placement:"bottom",popupDelay:100}),e.setTriggers({mouseenter:"mouseleave",click:"click",focus:"blur",never:"mouseleave","focus-not-typing":"blur-or-typing"})}]).config(["$stateProvider",function(e){e.state("ev-error",{templateUrl:"ev-error.phtml"})}]).config(["RestangularProvider",function(){}]).run(["$rootScope","$state","$location","uiSelect2Config",function(e,t,n,a){a.minimumResultsForSearch=7,a.allowClear=!0,e.$on("$stateChangeStart",function(t,n){n.state=n.name.split(".")[0],e["evmenu-state"]=n}),window.moment.lang([window.navigator.language,"en"])}]),angular.module("ev-fdm").animation(".ev-animate-picture-list",function(){return{enter:function(e,t){e.width();return e.css("opacity",0),jQuery(e).animate({opacity:1},300,t),function(t){t&&jQuery(e).stop()}},leave:function(e,t){return e.css("opacity",1),jQuery(e).animate({opacity:.3},300,t),function(t){t&&jQuery(e).stop()}},move:function(e,t){return e.css("opacity",0),jQuery(e).animate({opacity:1},t),function(t){t&&jQuery(e).stop()}},addClass:function(){},removeClass:function(){}}}),angular.module("ev-fdm").animation(".ev-animate-tag-list",function(){return{enter:function(e,t){return e.css("opacity",0),jQuery(e).animate({opacity:1},300,t),function(t){t&&jQuery(e).stop()}},leave:function(e,t){return e.css("opacity",1),jQuery(e).animate({opacity:.3},300,t),function(t){t&&jQuery(e).stop()}},move:function(e,t){return e.css("opacity",0),jQuery(e).animate({opacity:1},t),function(t){t&&jQuery(e).stop()}},addClass:function(){},removeClass:function(){}}}),angular.module("ev-fdm").factory("ListController",["$state","$stateParams","Restangular","communicationService",function(e,t,n,a){function r(e,t,n,r,i){var o=this;this.$scope=e,this.elementName=t,this.elements=n,this.defaultSortKey=r,this.defaultReverseSort=i,this.sortKey=this.defaultSortKey,this.reverseSort=this.defaultReverseSort,this.updateScope(),this.$scope.changePage=function(e){o.update(e,o.filters,o.sortKey,o.reverseSort)},this.$scope.sortChanged=function(){o.sortKey=o.$scope.sortKey,o.reverseSort=o.$scope.reverseSort,o.update(1,o.filters,o.sortKey,o.reverseSort)},this.$scope.toggleDetailView=function(e){o.toggleView("view",e)},a.on("common::filters.changed",function(e,t){this.filters=t,this.sortKey=this.defaultSortKey,this.update(1,this.filters,this.sortKey,this.reverseSort)}.bind(this)),this.$scope.$on("$stateChangeSuccess",function(e,t){t.name===o.elementName?o.$scope.activeElement=null:o.setActiveElement()}),a.on(this.elementName+"::updated",function(){o.update(o.$scope.currentPage,o.filters,o.sortKey,o.reverseSort)}),a.on(this.elementName+"::created",function(){o.update(o.$scope.currentPage,o.filters,o.sortKey,o.reverseSort)}),a.on(this.elementName+"::deleted",function(){o.update(o.$scope.currentPage,o.filters,o.sortKey,o.reverseSort)})}return r.prototype.update=function(e,t,n,a){this.fetch(e,t,n,a).then(function(e){this.elements=e,this.updateScope()}.bind(this))},r.prototype.updateScope=function(){if(this.$scope[this.elementName]=this.elements,this.$scope.currentPage=this.elements.pagination.current_page,this.$scope.pageCount=this.elements.pagination.total_pages,this.$scope.sortKey=this.sortKey,this.$scope.reverseSort=this.reverseSort,this.$scope.selectedElements&&this.elements){var e=this.elements.map(function(e){return n.configuration.getIdFromElem(e)});this.$scope.selectedElements=this.$scope.selectedElements.filter(function(t){return-1!==e.indexOf(n.configuration.getIdFromElem(t))})}else this.$scope.selectedElements=[];this.setActiveElement()},r.prototype.setActiveElement=function(){var t=this;this.$scope.activeElement=null,angular.isDefined(e.params.id)&&angular.forEach(this.elements,function(a){var r=n.configuration.getIdFromElem(a);r==e.params.id&&(t.$scope.activeElement=a)})},r.prototype.toggleView=function(a,r){if(!r)return void e.go(this.elementName);var i=n.configuration.getIdFromElem(r);i&&t.id!==i?e.go(this.elementName+"."+a,{id:i}):e.go(this.elementName)},r}]);var NotificationsController=["$scope","NotificationsService",function(e,t){e.notifications=t.list,e.$watch(function(){return t.activeNotification},function(){e.activeNotification=t.activeNotification}),e.getClass=function(e){if(!e)return"";switch(e.type){case t.type.ERROR:return"danger";case t.type.SUCCESS:return"success";case t.type.WARNING:return"warning";case t.type.INFO:return"info";default:return"success"}},e.remove=function(e){t.remove(e)}}];angular.module("ev-fdm").controller("NotificationsController",NotificationsController),angular.module("ev-fdm").factory("SearchController",["communicationService",function(e){function t(t){this.$scope=t,this.$scope.filters={},this.$scope.filtersChanged=function(){e.emit("common::filters.changed",this.$scope.filters)}.bind(this)}return t}]),angular.module("ev-fdm").factory("FilterService",["$rootScope","$timeout",FilterServiceFactory]),angular.module("ev-fdm").factory("Select2Configuration",["$timeout",function(e){return function(t,n,a,r,i){var o,l="",c={minimumInputLength:angular.isDefined(r)&&angular.isNumber(r)?r:3,allowClear:!0,query:function(n){var r=l===n.term?0:600;l=n.term,o&&e.cancel(o),o=e(function(){t(n.term,n.page).then(function(e){var t=[];a&&angular.forEach(e,function(e){t.push(a(e))});var r={results:t.length?t:e};if(e.pagination&&e.pagination.current_page<e.pagination.total_pages&&(r.more=!0),i&&n.term.length){var o={id:null};if(o[i]=n.term,r.results.length){var l=r.results.shift();r.results.unshift(l,o)}else r.results.unshift(o)}n.callback(r)})},r)},formatResult:function(e){return n(e)},formatSelection:function(e){return n(e)},initSelection:function(){return{}}};return c}}]),angular.module("ev-fdm").directive("activableSet",function(){return{restrict:"A",scope:!1,controller:["$scope","$attrs","$parse",function(e,t,n){var a=n(t.activeElement),r=a.assign,i=this;e.$watch(function(){return a(e)},function(e){i.activeElement=e}),this.toggleActive=function(n){n!==this.activeElement?(r&&r(e,n),this.activeElement=n):(r&&r(e,null),this.activeElement=void 0),e.$eval(t.activeChange)}}]}}).directive("activable",["$parse",function(e){return{restrict:"A",require:"^activableSet",link:function(t,n,a,r){n.addClass("clickable");var i=e(a.activable),o=i(t);t.$watch(function(){return i(t)},function(e){o=e}),t.$watch(function(){return r.activeElement},function(e){e&&o===e?n.addClass("active"):n.removeClass("active")}),n.on("click",function(e){$(e.target).closest(".block-active").length||e.ctrlKey||e.shiftKey||t.$apply(function(){r.toggleActive(o)})})}}}]);var module=angular.module("ev-fdm");module.directive("clearable",[function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){var r=angular.element('<button class="clear" ng-click="clear()">×</button>');t.after(r),r.on("click",function(){e.$apply(function(){t.val(""),a.$setViewValue("")})}),e.$watch(function(){return a.$isEmpty(a.$viewValue)},function(e){e?r.hide():r.show()})}}}]),angular.module("ev-fdm").directive("evDatepicker",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){var r="false"!==n.futurAllowed,i=n.dateFormat||"dd/mm/yy";$(function(){t.datepicker({dateFormat:i,maxDate:r?null:0,onSelect:function(t){a.$setViewValue(t),e.$apply()}})})}}}),angular.module("ev-fdm").directive("download",["$http","$location","$document","DownloadService",function(e,t,n,a){return{link:function(t,n,r){n.on("click",function(){e.get(r.download).success(function(e){a.download(e.url)})})}}}]),angular.module("ev-fdm").directive("evEditSection",[function(){return{restrict:"AE",transclude:!0,scope:{options:"="},template:'<div class="edit"><div ng-show="!options.edit"><span class="icon icon-edit"></span><button class="btn btn-link" ng-click="edit()">Editer</button></div><div ng-show="options.edit"><button class="btn btn-link" ng-click="save()"><span class="icon icon-tick"></span></button>&nbsp;<button class="btn btn-link" ng-click="cancel()"><span class="icon icon-cross"></span></button></div></div><div class="transclude"></div>',link:function(e,t,n,a,r){function i(e){o.edit=l.edit=e}var o={},l=e.options;e.edit=function(){(!l.onEdit||l.onEdit&&l.onEdit()!==!1)&&i(!0)},e.save=function(){(!l.onSave||l.onSave&&l.onSave()!==!1)&&i(!1)},e.cancel=function(){(!l.onCancel||l.onCancel&&l.onCancel()!==!1)&&i(!1)},r(function(e,n){n.edit=!!l.edit,o=n,t.find(".transclude").append(e)})}}}]),angular.module("ev-fdm").directive("ngEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.ngEnter)}),t.preventDefault())})}}),angular.module("ev-fdm").provider("menuManager",[MenuManagerProvider]).directive("evMenu",["menuManager",EvMenuDirective]);var module=angular.module("ev-fdm");module.directive("evFilters",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"filters.phtml"}}),function(){"use strict";angular.module("ev-fdm").directive("evFixedHeader",function(){return{link:function(e,t,n){t.addClass("full-height");var a=t.find(">.ev-header"),r=t.find(">.ev-body");r.css({"overflow-y":"auto"}),a.css({"overflow-y":"auto"});var i=function(){var e=t.innerHeight()-a.outerHeight(!0);return e-=r.outerHeight()-r.height()},o=function(){r.hide(),r.height(i()),r.show(),n.refreshIdentifier&&e.$broadcast("evFullHeightBody::refresh::"+n.refreshIdentifier)};e.$watch(function(){return i()},o),$(window).bind("resize",o),n.refreshOn&&e.$on("evFullHeightBody::refresh::"+n.refreshOn,o)}}})}(),angular.module("ev-fdm").directive("evFixedHeaders",["$timeout",function(e){function t(e,t){var n,a,r=angular.element(".table-container"),i=angular.element(".ev-fixed-header-table-container");return r.length?void t.$watch(function(){return n=r.height(),a=r.width(),n+"-"+a},function(){i.height(r.height()),e.floatThead("reflow")}):void console.log("Table should be wrapped inside a div having 'table-container' class to use evFixedHeaders directive")}function n(n,a){e(function(){t(n,a)},0,!1)}return{restrict:"A",replace:!1,scope:{rows:"="},link:function(e,a){var r=$(a);r.wrap('<div class="ev-fixed-header-table-container"></div>').floatThead({scrollContainer:function(e){return e.closest(".ev-fixed-header-table-container")}}),angular.element(".table-container").css("overflow","hidden"),$(window).on("resize",function(){t(r,e)}),e.$on("module-layout-changed",function(){n(r,e)}),e.$watch("rows",function(){n(r,e)},!0),n(r,e)}}}]);var module=angular.module("ev-fdm").directive("evFlag",function(){return{restrict:"E",replace:!0,scope:{lang:"="},template:'<i class="icon icon-flag flag-{{lang}}"></i>'}});angular.module("ev-fdm").directive("focus",[function(){return{link:function(e,t){e.$evalAsync(function(){t[0].focus()})}}}]),angular.module("ev-fdm").directive("linkDisabled",function(){return{restrict:"A",link:function(e,t,n){var a=n.ngClick;a&&e.$watch(n.linkDisabled,function(r,i){r?(t.unbind("click"),t.attr("disabled","disabled")):i&&(n.$set("ngClick",a),t.bind("click",function(){e.$apply(n.ngClick)}),t.removeAttr("disabled"))})}}});var module=angular.module("ev-fdm").directive("evLoadingDots",function(){return{restrict:"E",replace:!0,template:'<span class="loading-dots"><span></span><span></span><span></span></span>'}});angular.module("ev-fdm").directive("evModule",["$timeout","$rootScope",function(e,t){function n(e){return function(){angular.forEach(a,function(t,n){var a=e.find(".lisette-module-"+n),r="has-"+n;e.removeClass(_(t.versions).map(function(e){return n+"-"+e}).join(" ")),a.length?(e.addClass(r),angular.forEach(t.versions,function(t){a.hasClass("version-"+t)&&e.addClass(n+"-"+t)})):e.removeClass(r)}),t.$broadcast("module-layout-changed")}}var a={tabs:{versions:[]},topbar:{versions:["size-mini","size-default","size-big"]},leftbar:{versions:[]},bottombar:{versions:[]}};return{restrict:"A",link:function(t,a){a.addClass("lisette-module"),t.$on("$stateChangeSuccess",function(){e(n(a),0)}),e(n(a),0)}}}]),angular.module("ev-fdm").directive("evModuleHeader",["$timeout",function(e){function t(e){var t=e.find(".lisette-module-header");e.height(t.height()-1),t.affix({offset:{top:1}})}return function(n,a){var r=$(a);e(function(){t(r)},0,!1),$(window).on("resize",function(){t(r)}),n.$on("itemsLoaded",function(){t(r)})}}]),angular.module("ev-fdm").directive("mouseFollower",["$document",function(e){return{restrict:"A",link:function(t,n){n=angular.element(n),n.css("position","absolute"),n.css("z-index",1500),e.on("mousemove",function(e){n.css({left:e.pageX,top:e.pageY})})}}}]);var module=angular.module("ev-fdm").directive("evPagination",[function(){var e="...";return{restrict:"AE",replace:!0,templateUrl:"pagination.phtml",scope:{currPage:"=",nbPage:"=",onPageChange:"="},link:function(t){t.paginationButtons=[],t.prevClass="",t.nextClass="",t.currPage||(t.currPage=1),t.nbPage||(t.nbPage=1),t.generateButtons=function(){var n=2;t.paginationButtons=[],t.paginationButtons.push({value:1,"class":1==t.currPage?"active":""}),t.currPage-n>2&&t.paginationButtons.push({value:e,"class":"disabled"});for(var a=n;a>0;a--)t.currPage-a>1&&t.paginationButtons.push({value:t.currPage-a});1!=t.currPage&&t.currPage!=t.nbPage&&t.paginationButtons.push({value:t.currPage,"class":"active"});for(var a=1;n>=a;a++)t.currPage+a<t.nbPage&&t.paginationButtons.push({value:t.currPage+a});t.currPage+n<t.nbPage-1&&t.paginationButtons.push({value:e,"class":"disabled"}),t.nbPage>1&&t.paginationButtons.push({value:t.nbPage,"class":t.currPage==t.nbPage?"active":""})},t.previousPage=function(){t.currPage>1&&(t.currPage--,angular.isFunction(t.onPageChange)&&t.onPageChange(t.currPage))},t.changePage=function(n){n!=e&&n>=1&&n<=t.nbPage&&(t.currPage=n,angular.isFunction(t.onPageChange)&&t.onPageChange(n))},t.nextPage=function(){t.currPage<t.nbPage&&(t.currPage++,angular.isFunction(t.onPageChange)&&t.onPageChange(t.currPage))},t.$watch("nbPage + currPage",function(){t.generateButtons()})}}}]),module=angular.module("ev-fdm");module.directive("evPanelBreakpoints",["$timeout","$rootScope",function(e,t){function n(e){var t,n;for(n=0;n<i.length;n++)if(e<i[n]){t=i[n];break}return t?n:-1}function a(e,t){var n="";n=-1==t?"max":i[t],e.attr("data-breakpoint",n)}function r(e){var t=n(e.outerWidth());a(e,t)}var i=[100,200,300,400,500,600,700,800,900,1e3,1100];return{restrict:"A",scope:!1,replace:!0,transclude:!0,template:"<div ng-transclude></div>",link:function(n,a){a.resizable({handles:"w",helper:"ui-resizable-helper",resize:function(){r(a)}}),t.$on("module-layout-changed",function(){r(a)}),e(function(){r(a),a[0].focus()})}}}]),function(){"use strict";angular.module("ev-fdm").directive("evPictureList",function(){return{restrict:"EA",scope:{pictures:"=",editable:"=",onDelete:"&",onChange:"&",showUpdate:"=",language:"="},template:'<ul class="picture-list row"><li ng-repeat="picture in pictures track by picture.id" class="col-xs-4 ev-animate-picture-list"><figure><div class="picture-thumb" style="background-image: url(\'{{picture.id | imageUrl:245:150 | escapeQuotes }}\');"><div class="picture-thumb"><img src="{{picture.id | imageUrl:245:150 | escapeQuotes }}" /><button class="action update-action ev-upload-clickable"ng-click="onUpdate({picture: picture, index: $index})" data-ng-show="editable && showUpdate"><span class="icon icon-edit"></span></button><button class="action delete-action" ng-click="onDelete({picture: picture, index: $index})" tabIndex="-1"data-ng-show="editable"><span class="icon icon-bin"></span></button></div><figcaption><span class="copyright">&copy;</span><span class="author" data-ng-show="!editable">{{ picture.author }}</span><span data-ng-show="editable"><input type="text" class="form-control author" ng-model="picture.author" ng-change="onChange({picture: picture})"/></span></figcaption><figcaption ng-if="language"><span class="author" data-ng-show="!editable">{{ picture.legend[language].name }}</span><span data-ng-show="editable"><input type="text" class="form-control author" ng-model="picture.legend[language].name" ng-change="onChange({picture: picture})"/></span></figcaption></figure></li></ul><div class="clearfix"></div>',link:function(e,t,n){n.onDelete||(e.onDelete=function(t){e.pictures.splice(t.index,1)},e.onUpdate=function(e){console.log("et la maintenant ça update"),console.log(e)}),e.pictures=e.pictures||[]}}})}(),function(){"use strict";angular.module("template/popover/popover.html",[]).run(["$templateCache",function(e){e.put("template/popover/popover.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind-html="title" ng-show="title"></h3>\n      <div class="popover-content"ng-bind-html="content"></div>\n  </div>\n</div>\n')}]),angular.module("ev-fdm").directive("popover",["$timeout",function(e){return{restrict:"A",link:function(t,n){var a;n.bind("focus",function(){n.triggerHandler("focus-not-typing")}),n.bind("blur",function(){a&&e.cancel(a),n.triggerHandler("blur-or-typing")}),n.bind("keypress",function(){a&&e.cancel(a),n.triggerHandler("blur-or-typing"),a=e(function(){n.triggerHandler("focus-not-typing")},1e3)})}}}])}(),angular.module("ev-fdm").directive("promise",[function(){function e(e,t){t.removeClass("promise-resolved promise-resolving promise-empty promise-rejected"),t.addClass(e)}return{restrict:"A",replace:!1,controller:["$scope","$attrs","$parse","$element",function(t,n,a,r){var i=a(n.promise),o=n.emptyMessage,l="false"!==n.promiseDefaultStyles;l&&e("promise-default-styles",r),o&&r.append('<div class="promise-empty-message">'+o+"</div>"),t.$watch(function(){return i(t)},function(t){t?(e("promise-resolving",r),t.then(function(t){return o&&angular.isArray(t)&&!t.length?e("promise-resolved promise-empty",r):e("promise-resolved",r),t},function(){e("promise-rejected",r)})):e("promise-resolved",r)})}]}}]),function(){"use strict";angular.module("ev-fdm").directive("evPromiseProgress",[function(){return{restrict:"A",replace:!0,scope:{promise:"=evPromiseProgress"},template:'<div role="progressbar" class="ev-progress" aria-valuemin="0" aria-valuemax="100"aria-valuenow="0"> <div class="ev-progress-overlay"></div> </div> ',link:function(e,t){var n=t.find(angular.element(document.querySelector(".ev-progress-overlay")));n.css({width:"0%"}),e.$watch("promise",function(e){e&&e.then&&(n.css({width:"0%"}),e.then(null,null,function(e){"object"==typeof e&&(e=e.progress),n.css({width:e+"%"})}),e.finally(function(){n.css({width:"100%"})}))})}}}])}(),angular.module("ev-fdm").directive("body",["$rootScope","NotificationsService","$state",function(e,t,n){return{restrict:"E",link:function(a,r){e.$on("$stateChangeStart",function(e,t){var a=n.current.name.indexOf("."),r=-1!=a?n.current.name.substring(0,a):n.current.name;r&&0===t.name.indexOf(r)||$("body").addClass("state-resolving")}),e.$on("$stateChangeSuccess",function(){r.removeClass("state-resolving")}),e.$on("$stateChangeError",function(e,a){$("body").removeClass("state-resolving");var r=a.fallback&&a.fallback.message||"Error";t.addError({text:r}),a&&a.fallback&&a.fallback.state&&n.go(a.fallback.state)})}}}]),angular.module("ev-fdm").provider("evSelectLanguage",function(){this.$get=function(){return{availableLang:this.availableLang||[],defaultLang:this.defaultLang}},this.setAvailableLang=function(e){this.availableLang=e},this.setDefaultLang=function(e){this.defaultLang=e}}).directive("evSelectLanguage",["evSelectLanguage",function(e){return{template:'<div class="ev-language-tabs"><div class="btn-group"><button class="btn btn-lg btn-default" ng-repeat="lang in availableLang"ng-class="{active: selectedLang===lang}"ng-click="$parent.selectedLang=lang"><span class="ev-icons-flags" ng-class="\'icon-\' + lang"></span></button></div></div>',restrict:"AE",scope:{selectedLang:"=lang"},link:function(t){t.availableLang=e.availableLang,t.selectedLang||(t.selectedLang=e.defaultLang)}}}]),angular.module("ev-fdm").directive("selectableSet",[function(){return{restrict:"A",controller:["$scope","$parse","$element","$attrs","$document",function(e,t,n,a,r){function i(e,t){var n,a,r=o(t),i=Math.min(e,t),u=Math.max(e,t);if(angular.forEach(m,function(e){c(e)}),s.isElementSelected(r)){for(a=i;u>=a;a++)n=o(a),c(n);f=t,m.length=0}else for(m.length=0,a=i;u>=a;a++)n=o(a),l(n),m.push(n)}function o(e){return s.selectableElements[e]}function l(e){s.isElementSelected(e)||s.selectedElements.push(e)}function c(e){var t=s.selectedElements.indexOf(e);t>-1&&s.selectedElements.splice(t,1)}var s=this,u=16,d=t(a.selectedElements);this.selectableElements=[],this.selectedElement=[];var f,m=[];e.$watch(function(){return d(e)},function(){s.selectedElements=angular.isArray(d(e))?d(e):[]}),r.on("keydown",function(e){e.keyCode===u&&n.addClass("noselect")}),r.on("keyup",function(e){e.keyCode===u&&n.removeClass("noselect")}),this.toggleSelection=function(e,t){f=t,m.length=0,this.isElementSelected(e)?c(e):l(e)},this.toggleSelectAll=function(){this.selectedElements.length===this.selectableElements.length?this.selectedElements.length=0:angular.forEach(this.selectableElements,function(e){s.isElementSelected(e)||l(e)})},this.shiftedClick=function(e,t){void 0!==typeof f&&i(f,t)},this.registerElement=function(e){this.selectableElements.push(e)},this.unregisterElement=function(e){var t=this.selectableElements.indexOf(e);t>-1&&this.selectableElements.splice(t,1),t=this.selectedElements.indexOf(e),t>-1&&this.selectedElements.splice(t,1)},this.areAllElementSelected=function(){return this.selectedElements.length===this.selectableElements.length&&0!==this.selectedElements.length},this.isElementSelected=function(e){return s.selectedElements.indexOf(e)>-1}}]}}]).directive("selectable",["$parse",function(e){return{restrict:"A",require:["^selectableSet","?ngModel"],link:function(t,n,a,r){function i(e){e.shiftKey?c.shiftedClick(l,t.$index):(e.ctrlKey||angular.element(e.target).is(".checkbox"))&&c.toggleSelection(l,t.$index)}var o=e(a.selectable),l=o(t),c=r[0],s=r[1];c.registerElement(l),t.$on("$destroy",function(){c.unregisterElement(l)}),t.$watch(function(){return c.isElementSelected(l)},function(){t.selected=c.isElementSelected(l),s&&s.$setViewValue(t.selected)}),n.on("click",function(e){t.$apply(function(){i(e)})})}}}]).directive("selectBox",function(){return{restrict:"E",require:"^selectable",replace:!0,template:'<span class="checkbox" ng-class="{ active: selected }"></span>'}}).directive("selectAll",function(){return{restrict:"E",require:"^selectableSet",scope:!0,template:'<span class="checkbox" ng-class="{ active: allSelected }" ng-click="toggleSelectAll()"></span>',link:function(e,t,n,a){e.toggleSelectAll=function(){a.toggleSelectAll()},e.$watchCollection(function(){return a.areAllElementSelected()},function(){e.allSelected=a.areAllElementSelected()})}}}),angular.module("ev-fdm").directive("sortableSet",function(){return{restrict:"A",scope:!1,controller:["$scope","$parse","$element","$attrs",function(e,t,n,a){var r=this;this.reverseSort=!1,this.sortKey="",e.reverseSort=e.reverseSort||!1;var i=t(a.reverseSort),o=i.assign,l=t(a.sortBy),c=l.assign;e.$watch(function(){return i(e)},function(e){r.reverseSort=e}),e.$watch(function(){return l(e)},function(e){r.sortKey=e}),this.sortBy=function(t){t==this.sortKey?this.reverseSort=!this.reverseSort:(this.reverseSort=!1,this.sortKey=t),o&&o(e,this.reverseSort),c&&c(e,this.sortKey),e.$eval(a.sortChange)}}]}}).directive("sortable",function(){return{restrict:"A",scope:!1,require:"^sortableSet",link:function(e,t,n,a){function r(){a.sortKey===i?(t.removeClass("no-sort"),a.reverseSort?t.removeClass("sort-down").addClass("sort-up"):t.removeClass("sort-up").addClass("sort-down")):t.removeClass("sort-up sort-down").addClass("no-sort")}var i=n.sortable;t.addClass("sortable sort"),e.$watch(function(){return a.sortKey},function(){r()}),e.$watch(function(){return a.reverseSort},function(){r()}),t.on("click",function(){e.$apply(function(){a.sortBy(i)})})}}}),function(){"use strict";angular.module("ev-fdm").directive("evTab",function(){return{restrict:"E",transclude:!0,scope:{},controller:function(e){var t=e.panes=[];e.select=function(e){angular.forEach(t,function(e){e.selected=!1}),e.selected=!0},this.addPane=function(n){0===t.length&&e.select(n),t.push(n)};var n=function(t){var n;return t.some(function(t){var a=e.isShowed(t);return a&&(n=t),a}),n};this.selectNext=function(){var a=e.selectedIndex(),r=t.slice(a+1);e.select(n(r)||t[a])},this.selectPrevious=function(){var a=e.selectedIndex(),r=t.slice(0,a).reverse();e.select(n(r)||t[a])},e.selectedIndex=function(){for(var e=0;e<t.length;e++){var n=t[e];if(n.selected)return e}},e.isShowed=function(e){return null==e.tabShow||!!e.tabShow}},template:'<div class="tabbable" ev-fixed-header refresh-on="tab_container"><ul class="nav nav-tabs ev-header"><li ng-repeat="pane in panes | filter:isShowed" ng-class="{active:pane.selected}" tooltip="{{pane.tabTitle}}" tooltip-placement="bottom" tooltip-append-to-body="true"><a href="" ng-click="select(pane); pane.tabClick()"> <span ng-show="pane.tabIcon" class="icon {{pane.tabIcon}}"></span> <span ng-hide="pane.tabIcon">{{pane.tabTitle}}</span></a></li></ul><div class="tab-content ev-body" ng-transclude></div></div>',replace:!0}}).directive("evPane",function(){return{require:"^evTab",restrict:"E",transclude:!0,scope:{tabTitle:"@",tabIcon:"@",tabClick:"&",tabShow:"="},link:function(e,t,n,a,r){a.addPane(e),r(function(e,n){n.$selectNext=a.selectNext,n.$selectPrevious=a.selectPrevious,t.find(".transclude").append(e)})},template:'<div class="tab-pane" ng-class="{active: selected}"><div class="section transclude"></div></div>',replace:!0}})}(),angular.module("ev-fdm").directive("evTagList",function(){return{restrict:"EA",scope:{elements:"=",editable:"=",className:"@",maxElements:"=",maxAlertMessage:"@"},replace:!0,template:'<ul class="list-inline {{ className }}"><li ng-repeat="element in elements track by element.name" class="ev-animate-tag-list"><span class="label label-default" >{{ element.name }}<button ng-show="editable" tabIndex="-1" type="button" class="close inline" ng-click="remove($index)">×</button> </span></li><li ng-show="editable && elements.length >= maxElements" class="text-warning no-margin"> {{ maxAlertMessage }}</li></ul>',link:function(e){e.remove=function(t){e.elements.splice(t,1)}}}});var module=angular.module("ev-fdm");module.directive("throttle",["$timeout",function(e){return{restrict:"A",require:"ngModel",priority:1,link:function(t,n,a,r){var i=r.$setViewValue,o=angular.copy(r.$viewChangeListeners);r.$viewChangeListeners=[];var l;r.$setViewValue=function(t){var n=r.$modelValue!==t;i.apply(r,[t]),n&&(l&&e.cancel(l),l=e(function(){angular.forEach(o,function(e){try{e()}catch(t){$exceptionHandler(t)}})},600))}}}}]),angular.module("ev-fdm").directive("evValue",function(){return{restrict:"E",replace:!0,scope:{value:"=",noValue:"@"},templateUrl:"value.phtml"}}),"undefined"==typeof Fanny&&(Fanny={}),Fanny.Utils={generatedIds:{},generateId:function(e){var t=e+1e4*Math.random();return this.generatedIds[t]=!0,t},convertNumberToString:function(e,t,n){var a=" ",r=",",i="",o=[],l="",c="",s="";if("undefined"==typeof t&&(t=2),i=e+"",o=i.split("."),o.length<1&&o.length>2)throw new Error("Invalid number");if(l=o[0],1==o.length){c="";for(var u=0;t>u;u++)c+="0"}else if(c=o[1],c.length>t)c=c.substring(0,2);else for(;c.length<t;)c+="0";for(var u=0;u<l.length;u++)u%3==0&&0!=u&&(s=a+s),s=l[l.length-u-1]+s;""==s&&(s="0");for(var u=s.length;n>u;u++)s="0"+s;return c.length>0&&(s+=r+c),s},stringToVar:function(e){if("string"!=typeof e)throw new Error("Not a string");if(!isNaN(e))return parseInt(e);for(var t=e.split("."),n=window,a=0;a<t.length;a++){if(!t[a].length||"undefined"==typeof n[t[a]])throw new Error("No corresponding var found for "+e);n=n[t[a]]}return n},formatDate:function(e){if(!e||"object"!=typeof e)return"";var t=e.getFullYear(),n=this.convertNumberToString(e.getMonth()+1,0,2),a=this.convertNumberToString(e.getDate(),0,2);return t+"-"+n+"-"+a},Renderers:{date:function(e){var t=null,n=null;return t=e&&"object"==typeof e?e.date:e,"string"==typeof t&&t?(t=t.split(" ")[0],n=t.split("-"),3===n.length?n[2]+"/"+n[1]+"/"+n[0]:""):""},amounts:function(e){var t=Fanny.Utils.convertNumberToString(e,2);return e>=0?t:$("<span>").addClass("text-orange").html(t)},money:function(e,t){var n=t&&t.currency&&t.currency.symbole?t.currency.symbole:"€",a=Fanny.Utils.convertNumberToString(e,2)+" "+n;return e>=0?a:$("<span>").addClass("text-orange").html(a)},euros:function(e){var t=Fanny.Utils.convertNumberToString(e,2)+" €";return e>=0?t:$("<span>").addClass("text-orange").html(t)},upper:function(e){return"string"==typeof e?e.toUpperCase():e}}},angular.module("ev-fdm").filter("cleanupDate",function(){return function(e){var t="";if(e){var n=e.slice(0,4),a=e.slice(5,7),r=e.slice(8,10);t=r+"/"+a+"/"+n}return t}}),angular.module("ev-fdm").filter("cssify",function(){return function(e,t){var n="";if(t)for(var a in t)if(t.hasOwnProperty(a)&&e==a){n=t[a];break}return n}}),angular.module("ev-fdm").filter("prettySecs",[function(){return function(e){var t=parseInt(e,10),n=Math.floor(t/3600),a=Math.floor((t-3600*n)/60),r=t-3600*n-60*a;10>n&&(n="0"+n),10>a&&(a="0"+a),10>r&&(r="0"+r);var i=n+":"+a+":"+r;return i}}]),angular.module("ev-fdm").filter("replace",[function(){return function(e,t,n){return angular.isDefined(e)?e.replace(t,n||""):""}}]),angular.module("ev-fdm").filter("sum",["$parse",function(e){return function(t,n){if(!angular.isDefined(t))return 0;
var a=e(n);return t.reduce(function(e,t){var n=a(t);return e+(angular.isDefined(n)&&angular.isNumber(n)?parseFloat(n):0)},0)}}]),angular.module("ev-fdm").filter("unsafe",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]);var module=angular.module("ev-fdm");module.service("communicationService",["$rootScope",function(e){var t="evfdm-communication",n=function(t,n){e.$emit(t,n)},a=function(t,n){e.$on(t,n)},r=function(n,a){void 0===e[t]&&(e[t]={}),e[t][n]=a},i=function(n){var a=null;return e[t]&&void 0!==e[t][n]&&(a=e[t][n]),a},o={emit:n,on:a,set:r,get:i};return o}]),angular.module("ev-fdm").service("DownloadService",["$document",function(e){var t=null;return{download:function(n){t||(t=e[0].createElement("iframe"),t.style.display="none",e[0].body.appendChild(t)),t.src=n}}}]),angular.module("ev-fdm").service("FilteringService",["$location",function(){var e={};return{setSelectedFilter:function(t,n){e[t]=void 0!=n&&"undefined"!=n?n:""},getSelectedFilter:function(t){var n="";return"undefined"!=typeof e[t]&&"undefined"!=e[t]&&(n=e[t]),n},getAllFilters:function(){return e}}}]);var module=angular.module("ev-fdm"),ModalService=function(e,t,n,a){this.$rootScope=e,this.$templateCache=t,this.$compile=n,this.$controller=a};ModalService.prototype.open=function(e){e=this._readOptions(e);var t=(e.parentScope||this.$rootScope).$new();t=_(t).extend(e.scope);var n;e.controller&&(n=this.$controller(e.controller,{$scope:t}));var a=this.$compile(e.template||this.$templateCache.get(e.templateUrl))(t);return a.$scope=t,a.$controller=n,n&&(n.$modal=a),$(a).modal(e)},ModalService.prototype._readOptions=function(e){if(e=_({backdrop:!0,scope:{},keyboard:!0}).extend(e),!e.templateUrl&&!e.template)throw new Error("Either template or templateUrl have to be defined");return e},module.service("ModalService",["$rootScope","$templateCache","$compile","$controller",ModalService]);var module=angular.module("ev-fdm");module.service("NotificationsService",["$timeout",function(e){function t(e){e.type||(e.type=c.SUCCESS),r(e)}function n(e){o=_(o).without(e),a()}function a(){if(o.length){var t=o[0];i.activeNotification!==t&&(i.activeNotification=t,-1!==t.delay&&e(function(){n(t)},1e3*(t.delay||l)))}else i.activeNotification=null}function r(e){o.push(e),a()}var i=this,o=[],l=5,c={SUCCESS:0,ERROR:1,INFO:2,WARNING:3};this.activeNotification=null,this.add=t,this.remove=n,this.addError=function(e){e.type=c.ERROR,t(e)},this.addSuccess=function(e){e.type=c.SUCCESS,t(e)},this.type=c}]);var module=angular.module("ev-fdm");module.service("PanelService",["$animate","$q","$http","$templateCache","$compile","$rootScope","$timeout","$window","PanelLayoutEngine",function(e,t,n,a,r,i,o,l,c){function s(e){var t=v[e];return t?"width: "+t+"px;":""}function u(e){return e.template||e.templateURL?t.when(e.template):n.get(e.templateUrl,{cache:a}).then(function(e){return e.data})}function d(e){var t=angular.element(g).children(),n=e-1;return!e||e>t.length?n=t.length-1:1>e&&(n=0),n}function f(e){var t=angular.element(g).children(),n=t[e];return n?angular.element(n):null}function m(e){var t=angular.element(g).children(".ev-panel-placeholder");if(e)for(var n=0;n<t.length;n++){var a=t[n];if(e==a){t.splice(n,1),t.push(e);break}}c.checkStacking(t)}var g=null,v=window.stylesCache={};self=this,this.panels={},this.open=function(t){if(!t.name&&t.panelName&&(console.log("Deprecated: use name instead of panelName"),t.name=t.panelName),!t)return void console.log("A panel must have a name (options.name)");var n=t.name;if(self.panels[n]){var a=self.panels[n];a.index=t.index;var o=d(t.index),l=f(o);return a.element.css("z-index",2e3+o),e.move(a.element,g,l,function(){m()}),self.panels[n]}var c=angular.element('<div class="ev-panel-placeholder ev-panel-placeholder-'+n+'" ev-panel-breakpoints style="'+s(n,t)+'"   ><div class="ev-panel" ><div class="ev-panel-inner"><div class="ev-panel-content"></div></div></div></div>'),p=u(t);return self.panels[n]=t,t.element=c,t.element.css("z-index",2e3+t.index),p.then(function(n){c.find(".ev-panel-content").html(n),c=r(c)(i.$new()),t.element=c;var a=d(t.index),o=f(a);return c.on("resizestop",function(e,n){n.originalSize;$(this).css("height",""),v[t.panelName]=n.size.width,m(self)}).on("resize",function(){return!1}),e.enter(c,g,o,function(){m()}),t})},this.close=function(t){t&&self.panels[t]||console.log("Panel not found for:"+t);var n=self.panels[t].element;self.panels[t]=null,e.leave(n,function(){m()})},this.registerContainer=function(e){g=e};var p=null;return angular.element(l).on("resize",function(){null!==p&&o.cancel(p),p=o(function(){m()},100)}),this}]).directive("evPanels",["PanelService",function(e){return{restrict:"AE",scope:{},replace:!0,template:'<div class="ev-panels ev-panels-container lisette-module"><div></div></div>',link:function(t,n){e.registerContainer(n)}}}]);var module=angular.module("ev-fdm"),SidonieModalService=function(e,t,n){function a(t,a,r){var i=o(t),s=i.multi,u=i.opened;if(r.windowClass||(r.windowClass=" fade "),r.windowClass+=" "+t,r.templateUrl||r.template||(r.templateUrl=a+".phtml"),r.backdrop=t==SidonieModalService.REGION_MIDDLE,s)throw new Error("Multi not implemented yet");if(u.length){var d=u[u.length-1];if(d.status==SidonieModalService.STATUS_LOCKED)return n.warn("Open modal aborted due to "+d.sidonieModalType+"'s locked status"),c(d),!1;if(d.sidonieModalType!=a){d.modal("hide");var f=e.open(r);return f.sidonieModalType=a,f.result.finally(l(t,f)),i.opened=[f],f}return d}var f=e.open(r);return f.sidonieModalType=a,f.result.finally(l(t,f)),i.opened=[f],f}function r(){var e=!1;return angular.forEach(s,function(t){angular.forEach(t.opened,function(t){e||t.status==SidonieModalService.STATUS_LOCKED&&(c(t),n.warn("Open modal aborted due to "+t.sidonieModalType+"'s locked status"),e=t)})}),e?e:(angular.forEach(s,function(e){angular.forEach(e.opened,function(e){try{e.close()}catch(t){}})}),!0)}function i(e,t){var n=o(e);if(n.modals.length){var a=n.modals[n.modals.length-1];return t&&a.sidonieModalType!=t?!1:a}}function o(e){var t=s[e];if("undefined"==typeof t)throw new Error("Unknown region "+e);return t}function l(e,t){return function(){var n=o(e);angular.forEach(n.opened,function(e){t==e&&(n.opened=_(n.opened).without(t))})}}function c(e){t.addClass(e,"modal-locked",function(){t.removeClass(e,"modal-locked")})}var s={};return s[SidonieModalService.REGION_RIGHT]={multi:!1,opened:[]},s[SidonieModalService.REGION_MIDDLE]={multi:!1,opened:[]},{open:a,openRight:function(e,t){a(SidonieModalService.REGION_RIGHT,e,t)},openMiddle:function(e,t){a(SidonieModalService.REGION_MIDDLE,e,t)},get:i,closeAll:r}};SidonieModalService.STATUS_LOCKED="locked",SidonieModalService.REGION_RIGHT="right",SidonieModalService.REGION_MIDDLE="middle",module.service("SidonieModalService",["$modal","$animate","$log",SidonieModalService]);var module=angular.module("ev-fdm");module.service("SortService",[function(){var e="",t=!1,n=function(){return e},a=function(n){return n==e?t=!t:e=n,this},r=function(n){var a="sort ";return a+=n==e?t?"sort-up":"sort-down":"no-sort"},i=function(e){t=e},t=function(){return t};return{sortBy:a,getSortCSS:r,getCurrentSort:n,setReverse:i,isReverse:t}}]);var module=angular.module("ev-fdm"),AbstractAutocompleteStorage=function(e,t){_.extend(this,e),this.AbstractStorage=e,this.$timeout=t};AbstractAutocompleteStorage.prototype.generateAutocompleteConfig=function(e,t,n){var a,r=this;return{minimumInputLength:n,allowClear:!0,initSelection:function(){return""},query:function(n){var i=n.term;a&&r.$timeout.cancel(a),a=r.$timeout(function(){e.call(r,i.toUpperCase()).then(function(e){var a=t(e);n.callback({results:a})})},600)}}},module.service("AbstractAutocompleteStorage",["Storage","$timeout",AbstractAutocompleteStorage]),angular.module("ev-fdm").service("AjaxStorage",["$http","$q","$cacheFactory","$log",AjaxStorage]),angular.module("ev-fdm").factory("RestangularStorage",["$q","Restangular","communicationService",function(e,t,n){function a(e,a){this.restangular=t,this.resourceName=e,this.defaultEmbed=a||[],this.emitEventCallbackCreator=function(e,t){return function(a){return n.emit(this.resourceName+"::"+e,t),a}.bind(this)}.bind(this)}return a.buildSortBy=function(e,t){var n=t?"DESC":"ASC";return e+":"+n},a.buildEmbed=function(e){return e.join(",")},a.buildParameters=function(e,t){var n={};return angular.isArray(t)&&t.length?n.embed=a.buildEmbed(t.concat(e.defaultEmbed)):e.defaultEmbed.length&&(n.embed=a.buildEmbed(e.defaultEmbed)),n},a.buildFilters=function(e){var t={};return angular.forEach(e,function(e,n){angular.isObject(e)&&angular.isDefined(e.uuid)?t[n+".uuid"]=e.uuid:angular.isObject(e)&&angular.isDefined(e.id)?t[n+".id"]=e.id:angular.isArray(e)&&e.length>0?t[n]=e.join(","):angular.isDate(e)?t[n]=e.toISOString():angular.isDefined(e)&&""!==e&&null!==e&&(t[n]=e)}),t},a.prototype.getList=function(e,t,n,r,i){var o={};return angular.isNumber(e)&&e>0&&(o.page=e),angular.isArray(t)&&t.length?o.embed=a.buildEmbed(t.concat(this.defaultEmbed)):this.defaultEmbed.length&&(o.embed=a.buildEmbed(this.defaultEmbed)),r&&(o.sortBy=a.buildSortBy(r,i)),n&&(n=a.buildFilters(n),angular.extend(o,n)),this.restangular.all(this.resourceName).getList(o)},a.prototype.getById=function(e,t){return this.restangular.one(this.resourceName,e).get(a.buildParameters(this,t))},a.prototype.update=function(e,t){return e.put(a.buildParameters(this,t)).then(this.emitEventCallbackCreator("updated",[e]))},a.prototype.updateAll=function(t,n){var r=a.buildParameters(this,n);return e.all(t.map(function(e){return e.put(r)})).then(this.emitEventCallbackCreator("updated",t))},a.prototype.patch=function(e,t,n){return angular.extend(e,t),e.patch(t,a.buildParameters(this,n)).then(this.emitEventCallbackCreator("updated",[e]))},a.prototype.patchAll=function(t,n,r){t.forEach(function(e){angular.extend(e,n)});var i=a.buildParameters(this,r);return e.all(t.map(function(e){return e.patch(n,i)})).then(this.emitEventCallbackCreator("updated",t))},a.prototype.create=function(e,t){return this.restangular.all(this.resourceName).post(e,a.buildParameters(this,t)).then(this.emitEventCallbackCreator("created",[e]))},a.prototype.delete=function(e){return e.remove().then(this.emitEventCallbackCreator("deleted",[e]))},a.prototype.deleteAll=function(t){return e.all(t.map(function(e){return e.remove()})).then(this.emitEventCallbackCreator("deleted",t))},a.prototype.save=function(e,t){return e.save(a.buildParameters(this,t)).then(this.emitEventCallbackCreator("updated",[e]))},a.prototype.saveAll=function(t,n){var r=a.buildParameters(this,n);return e.all(t.map(function(e){return e.save(r)})).then(this.emitEventCallbackCreator("updated",t))},a.prototype.getNew=function(){return this.restangular.one(this.resourceName)},a}]);var module=angular.module("ev-fdm");module.service("Storage",["AjaxStorage",Storage]);var angularLocalStorage=angular.module("LocalStorageModule",[]);angularLocalStorage.value("prefix","ls"),angularLocalStorage.constant("cookie",{expiry:30,path:"/"}),angularLocalStorage.constant("notify",{setItem:!0,removeItem:!1}),angularLocalStorage.service("localStorageService",["$rootScope","prefix","cookie","notify",function(e,t,n,a){"."!==t.substr(-1)&&(t=t?t+".":"");var r=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.message),!1}},i=function(n,i){if(!r())return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),a.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:n,newvalue:i,storageType:"cookie"}),d(n,i);"undefined"==typeof i&&(i=null);try{(angular.isObject(i)||angular.isArray(i))&&(i=angular.toJson(i)),localStorage.setItem(t+n,i),a.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:n,newvalue:i,storageType:"localStorage"})}catch(o){return e.$broadcast("LocalStorageModule.notification.error",o.message),d(n,i)}return!0},o=function(n){if(!r())return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),f(n);var a=localStorage.getItem(t+n);return a?"{"===a.charAt(0)||"["===a.charAt(0)?angular.fromJson(a):a:null},l=function(n){if(!r())return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),a.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:n,storageType:"cookie"}),m(n);try{localStorage.removeItem(t+n),a.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:n,storageType:"localStorage"})}catch(i){return e.$broadcast("LocalStorageModule.notification.error",i.message),m(n)}return!0},c=function(){if(!r())return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;var n=t.length,a=[];for(var i in localStorage)if(i.substr(0,n)===t)try{a.push(i.substr(n))}catch(o){return e.$broadcast("LocalStorageModule.notification.error",o.Description),[]}return a},s=function(){if(!r())return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),g();var n=t.length;for(var a in localStorage)if(a.substr(0,n)===t)try{l(a.substr(n))}catch(i){return e.$broadcast("LocalStorageModule.notification.error",i.message),g()}return!0},u=function(){try{return navigator.cookieEnabled||"cookie"in document&&(document.cookie.length>0||(document.cookie="test").indexOf.call(document.cookie,"test")>-1)}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.message),!1}},d=function(a,r){if("undefined"==typeof r)return!1;if(!u())return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var i="",o=new Date;null===r&&(n.expiry=-1,r=""),0!==n.expiry&&(o.setTime(o.getTime()+24*n.expiry*60*60*1e3),i="; expires="+o.toGMTString()),a&&(document.cookie=t+a+"="+encodeURIComponent(r)+i+"; path="+n.path)}catch(l){return e.$broadcast("LocalStorageModule.notification.error",l.message),!1}return!0},f=function(n){if(!u())return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var a=document.cookie.split(";"),r=0;r<a.length;r++){for(var i=a[r];" "==i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t+n+"="))return decodeURIComponent(i.substring(t.length+n.length+1,i.length))}return null},m=function(e){d(e,null)},g=function(){for(var e=null,n=t.length,a=document.cookie.split(";"),r=0;r<a.length;r++){for(e=a[r];" "==e.charAt(0);)e=e.substring(1,e.length);key=e.substring(n,e.indexOf("=")),m(key)}};return{isSupported:r,set:i,add:i,get:o,keys:c,remove:l,clearAll:s,cookie:{set:d,add:d,get:f,remove:m,clearAll:g}}}]),angular.module("ev-fdm").directive("disableValidation",function(){return{require:"^form",restrict:"A",link:function(e,t,n,a){var r;e.$watch(n.disableValidation,function(e){r||(r=a[t.attr("name")]),e===!1?(a.$addControl(r),angular.forEach(r.$error,function(e,t){a.$setValidity(t,!e,r)})):a.$removeControl(r)})}}}),angular.module("ev-fdm").directive("strictMin",function(){return{require:"ngModel",link:function(e,t,n,a){function r(e){var t=parseFloat(e),r=parseFloat(n.strictMin);return t>r?(a.$setValidity("strictMin",!0),e):void a.$setValidity("strictMin",!1)}a.$parsers.unshift(r),a.$formatters.push(r)}}});var module=angular.module("ev-fdm");module.service("PanelLayoutEngine",["$animate","$rootScope","$window",function(e,t,n){function a(e){{var t=[];e.size()}return angular.forEach(e,function(e){var n=angular.element(e),a={minWidth:parseInt(n.children().first().css("min-width"))||d,maxWidth:parseInt(n.children().first().css("max-width"))||0,stacked:n.hasClass("stacked"),width:n.width(),stackedWidth:d};a.width<a.minWidth&&(a.width=a.minWidth),a.width>a.maxWidth&&a.maxWidth>0&&(a.width=a.maxWidth),t.push(a)}),t}function r(e,t){for(var n=0,a=0,r=0,i=e.length,o=0,l=null;i>a;a++){for(o=0,r=0;i>r;r++)if(l=e[r],a>r)o+=l.stackedWidth;else{var c=l.minWidth;c<l.stackedWidth&&(c=l.stackedWidth),o+=c}o>t&&n++}return n}function i(e,t){for(var n=e.length,a=e.length,r=a,i=0,o=0,l=null;r>0;r--){for(o=0,i=0;a>i;i++)if(l=e[i],r>i)o+=l.stackedWidth;else{var c=l.maxWidth;c<l.stackedWidth&&(c=l.stackedWidth),o+=c}t>o&&n--}return n}function o(e,t){var n=r(e,t),a=i(e,t);angular.forEach(e,function(e){e.stacked=!1});var o=n;e.length-n>3&&e.length-a<=3&&(o=e.length-3);for(var l=0;o>l;l++)e[l].stacked=!0;return{nbStacked:o,datas:e}}function l(e,t){var n=0;angular.forEach(e,function(e){e.width<e.minWidth&&(e.width=e.minWidth),n+=e.stacked?e.stackedWidth:e.width});var a=t-n,r=e.length;data=null;for(var i=0;r>i;i++)if(data=e[i],data.stacked)data.width=data.stackedWidth;else{var o=data.width,l=data.width+a;if(data.width=data.minWidth>l?data.minWidth:0!==data.maxWidth&&data.maxWidth<l?data.maxWidth:data.width+a,a-=data.width-o,0===a)break}return e}function c(e,t){var n=o(e,t);return e=n.datas,n.nbStacked!==e.length&&(e=l(e,t)),e}function s(t,n,a){var r=!1,i=n[n.length-1];i.stacked===!0&&(i.stacked=!1,i.width=a,r=!0);t.size();t.css("left",0),angular.forEach(t,function(t,a){var i=angular.element(t),o=n[a];return i?(i.hasClass("stacked")&&!o.stacked?(e.removeClass(i,"stacked"),e.removeClass(i,"stacked-mobile")):!i.hasClass("stacked")&&o.stacked&&(e.addClass(i,"stacked"),r&&e.addClass(i,"stacked-mobile")),void i.width(o.width+"px")):void console.log("no element for this panel)")})}function u(e){var r=angular.element("body"),i=r.css("overflow");r.css("overflow","hidden");var o=angular.element(n).innerWidth();r.css("overflow",i);var l=a(e),u=c(l,o);s(e,u,o),t.$broadcast("module-layout-changed")}var d=35,f={checkStacking:u};return f}]);

angular.module("ev-leaflet",["leaflet-directive"]).provider("evLeaflet",function(){this.$get=function(){return{icons:this.icons}},this.setIcons=function(e){this.icons=e}}).directive("evLeaflet",["leafletData","evLeaflet","$log",function(e,a,t){return{template:'<leaflet class="ev-leaflet" defaults="defaults" markers="markers" center="center"></leaflet>',restrict:"AE",scope:{coordinate:"=",editable:"="},controller:function(e){function r(){e.center={lat:e.markers.marker.lat,lng:e.markers.marker.lng,zoom:8}}var n={iconSize:[40,40],shadowSize:[1,1],iconAnchor:[1,20]},l=a.icons;"default"in l&&angular.extend(l.default,n),"draggable"in l&&angular.extend(l.draggable,n),e.defaults={scrollWheelZoom:!1,doubleClickZoom:!1},e.markers={marker:{focus:!0}},r(),e.$watch("coordinate.latitude",function(a){isNaN(a)&&(a=0,t.warn("ev-leaflet: latitude is not a number")),e.markers.marker.lat=a,r()}),e.$watch("coordinate.longitude",function(a){isNaN(a)&&(a=0,t.warn("ev-leaflet: longitude is not a number")),e.markers.marker.lng=a,r()}),e.$watch("markers.marker.lat",function(a){e.coordinate.latitude=a}),e.$watch("markers.marker.lng",function(a){e.coordinate.longitude=a}),e.$watch("editable",function(){var a=e.editable;e.markers.marker.icon=a?l.draggable:l["default"],e.markers.marker.draggable=a})}}}]);

angular.module("ev-tinymce",["ui.tinymce"]).directive("evTinymce",[function(){return{template:'<div class="tiny-mce-wrapper"><textarea ui-tinymce="tinymceFinalOptions" ng-model="ngModel" ng-required="ngRequired"></textarea><span class="max-chars-info">&nbsp;</span></div>',restrict:"AE",replace:!1,scope:{ngModel:"=",tinymceOptions:"=",ngRequired:"&"},controller:["$scope","$attrs","$element",function(n,e,t){n.$on("module-layout-changed",function(){var n=t.find("textarea").attr("id"),e=window.tinyMCE,a=e.get(n);if(a)try{a.remove(),e.execCommand("mceAddEditor",!1,n)}catch(i){}});var a={menubar:!1,statusbar:!1,resize:!1,toolbar:"bold italic underline | alignleft aligncenter alignright | bullist",content_css:"/bower_components/ev-fdm/dist/css/ev-fdm.min.css",skin:!1,verify_html:!0,convert_fonts_to_spans:!0};n.tinymceFinalOptions=angular.extend({},a,n.tinymceOptions),n.tinymceFinalOptions.maxChars=e.maxChars||n.tinymceFinalOptions.maxChars||null;var i=85,r=function(n,e){var a=t.parent().find(".max-chars-info");a.text(n+" / "+e);var r=n/e*100>i,s=n>=e,l="max-chars-warning",o="max-chars-reached";r?a.addClass(l):a.removeClass(l),s?a.addClass(o):a.removeClass(o)},s=function(e){if(null!==n.tinymceFinalOptions.maxChars){var t="",a="",i="",s=n.tinymceFinalOptions.maxChars;e.on("init",function(){n.$watch(function(){return e.getContent()},function(e,l){t=angular.element(e).text(),a=t.length,i=angular.element(l).text();var o=i.length>s&&a>s;if(o){var c=i.substring(0,s);n.ngModel=c,a=c.length}else a>s&&(n.ngModel=l,a=angular.element(n.ngModel).text().length);r(a,s)})})}};n.tinymceFinalOptions.setup=s}]}}]);

!function(){"use strict";angular.module("ev-upload",["ev-fdm"])}(),function(){"use strict";angular.module("ev-upload").directive("evPictureButtonUpload",["NotificationsService","$http",function(e){return{restrict:"AE",scope:{pictures:"=",buttonText:"@",iconName:"@",url:"@",language:"="},template:'<ev-upload settings="settings" file-success="addPicture(file)"upload="newUpload(promise)"><div ng-hide="uploading"><button type="button" tabIndex="-1" class="btn btn-link ev-upload-clickable"><span class="icon {{iconName}}"></span>{{buttonText}}</button></div><div class="ev-picture-uploading" ng-show="uploading"><div class="ev-picture-upload-label"> {{"Upload en cours"| i18n}} </div><div class="spinner"></div><p> {{upload.done}} / {{upload.total}} {{ "photo(s) uploadée(s)" | i18n }} </p></div><div ng-show="uploading" ev-promise-progress="uploadPromise"></div></ev-upload>',link:function(e){e.settings={acceptedFiles:"image/*",url:e.url}},controller:function(n){n.$watch("url",function(e){n.settings.url=e}),n.uploading=!1,n.newUpload=function(t){n.upload=null,n.uploading=!0,n.uploadPromise=t,t.then(function(){e.addSuccess({text:"Les images ont été uploadées avec succès"})},function(){e.add({type:e.type.WARNING,text:"Certaines images n'ont pas pu être uploadées."})},function(e){n.upload=e}).finally(function(){n.uploading=!1})},n.addPicture=function(e){console.log(e);var t=e.data[0];n.language&&(Array.isArray(t.legend)&&(t.legend={}),t.legend[n.language]||(t.legend[n.language]={name:""})),n.pictures.unshift(t)}}}}])}(),function(){"use strict";angular.module("ev-upload").directive("evPictureUpload",["NotificationsService","$http",function(e,n){return{restrict:"AE",scope:{pictures:"=",url:"@",language:"="},template:'<ev-upload settings="settings" file-success="addPicture(file)"class="ev-picture-upload" upload="newUpload(promise)"><div ng-hide="uploading"><div class="ev-picture-upload-label">{{ "Faites glisser vos images ici" | i18n }}</div><table style="width:100%"><tr><td style="width:114px"><button type="button" tabIndex="-1" class="btn btn-default ev-upload-clickable">{{ "Importer..." | i18n}}</button></td><td style="width:30px´; line-height: 36px;">{{ "ou" | i18n }}</td><td><form novalidate name="flickr" ng-class="{\'has-error\': flickr.$dirty && flickr.$invalid}"><input name="fUrl" placeholder="{{\'Lien Flickr\' | i18n}}" ng-model="$parent.flickrUrl" ng-pattern="flickrUrlPattern" required="" class="form-control" ng-change="uploadFlickrUrl(flickr)"/><div ng-show="flickr.fUrl.$dirty && flickr.fUrl.$invalid"><p class="control-label" for="fUrl" data-ng-show="flickr.fUrl.$error.pattern">{{ "L\'url doit être une photo flickr" | i18n}}</p></div></form></td></tr></table></div><div class="ev-picture-uploading" ng-show="uploading"><div class="ev-picture-upload-label"> {{"Upload en cours"| i18n}} </div><div class="spinner"></div><p> {{upload.done}} / {{upload.total}} {{ "photo(s) uploadée(s)" | i18n }} </p></div><div ng-show="uploading" ev-promise-progress="uploadPromise"></div></ev-upload>',link:function(e){e.flickrUrlPattern=/^(https\:\/\/)?www\.flickr\.com\/photos\/.*\/\d+.*$/,e.settings={acceptedFiles:"image/*",url:e.url}},controller:function(t){t.$watch("url",function(e){t.settings.url=e}),t.uploading=!1,t.uploadFlickrUrl=function(e){if(e.$valid){var l=/(https\:\/\/)?www\.flickr\.com\/photos\/.*\/\d+/.exec(t.flickrUrl)[0],o=n.post(t.url,{"flickr-url":l});o.success(function(e){t.pictureSuccess({picture:e})}).success(function(){e.$setPristine(),t.flickrUrl=""}),t.newUpload(o),t.upload={done:0,total:1,progress:0}}},t.newUpload=function(n){t.upload=null,t.uploading=!0,t.uploadPromise=n,n.then(function(){e.addSuccess({text:"Les images ont été uploadées avec succès"})},function(){e.add({type:e.type.WARNING,text:"Certaines images n'ont pas pu être uploadées."})},function(e){t.upload=e}).finally(function(){t.uploading=!1})},t.addPicture=function(e){console.log(e);var n=e.data[0];t.language&&(Array.isArray(n.legend)&&(n.legend={}),n.legend[t.language]||(n.legend[t.language]={name:""})),t.pictures.unshift(n)}}}}])}(),function(e){"use strict";angular.module("ev-upload").directive("evUpload",["$log","$q","$timeout",function(n,t,l){var o={previewTemplate:!1,previewsContainer:!1,autoQueue:!0,maxFilesize:12,maxFiles:100,uploadMultiple:!1,parallelUploads:3};return{transclude:!0,restrict:"EA",replace:!0,scope:{settings:"=",uploadStart:"&upload",fileSuccess:"&",fileAdded:"&"},template:'<div class="ev-upload"><div ng-transclude> </div></div>',link:function(i,a){function r(e){return s.getAcceptedFiles().reduce(function(n,t){return n+t.upload[e]},0)}function d(){var e=a.find(".ev-upload-dropzone");return 0===e.length&&(e=a),e.addClass("dz-default"),e.addClass("dz-message"),e[0]}function u(){return a.find(".ev-upload-clickable")[0]}function c(n){p={done:0,progress:0};var o=function(){p.progress=100*r("bytesSent")/r("total"),p.total=s.getAcceptedFiles().length,i.deferred.notify(p)};s.off("uploadprogress",o).off("maxfilesexceeded");var i={deferred:t.defer(),hasFileErrored:!1};o(),s.once("error",function(){i.hasFileErrored=!0}),s.on("uploadprogress",o);var a=function(){return!s.files.filter(function(n){return n.status===e.QUEUED||n.status===e.ADDED||n.status===e.UPLOADING}).length},d=function(){n.$apply(function(){l(function(){a()&&(s.off("complete",d),l(function(){i.hasFileErrored?i.deferred.reject("filehaserrored"):i.deferred.resolve()}))})})};s.on("maxfilesexceeded",function(){i.deferred.reject("maxfilesexceeded")}),s.on("complete",d),n.currentUpload=i.deferred.promise,n.uploadStart({promise:i.deferred.promise}),n.currentUpload.finally(function(){s.removeAllFiles(!0),n.currentUpload=null})}i.fileSuccess=i.fileSuccess||function(){},i.fileAdded=i.fileAdded||function(){};var s=null,p=null,f={};i.$watch("settings",function(l){return l.url?(null!==s&&s.destroy(),l=angular.extend(o,l),s=new e(d(),angular.extend({clickable:u()},l)),i.currentUpload=null,s.on("addedfile",function(e){null===i.currentUpload&&i.$apply(c);var n=t.defer();f[e.name]=n;var l=function(){s.removeFile(e)};i.$apply(function(t){t.fileAdded({dropzoneFile:e,promise:n.promise,cancel:l})})}),s.on("uploadprogress",function(e,n){i.$apply(function(){f[e.name].notify(n)})}),s.on("success",function(e,n){i.$apply(function(t){f[e.name].resolve({file:n}),t.fileSuccess({file:n})})}),s.on("error",function(e,n,t){n||500!==t.status||(n=l.dictResponseError||"Unexpected error during the upload"),"Upload canceled."===n&&(n=l.dictCanceledUpload||"The upload has been canceled"),i.$apply(function(){f[e.name].reject(n)})}),s.on("canceled",function(e){var n=f[e.name];i.$apply(function(){n.reject(l.dictCanceledUpload||"The upload has been canceled")})}),void s.on("complete",function(){angular.isDefined(p)&&(p.done+=1)})):void n.warn("No url provided to the upload zone")},!0),i.$on("$destroy",function(){s.destroy()})}}}])}(Dropzone);

//# sourceMappingURL=ev-fdm.min.js.map