function FilterServiceFactory(e,t){function n(){this.filters={};var n=[],r=this;e.$watch(function(){return r.filters},function(e,n){n!==e&&t(function(){r.modifier?r.modifier.call(r,e,n):r.callListeners()},0)},!0),this.setModifier=function(e){angular.isFunction(e)&&(this.modifier=e)},this.addListener=function(e,t){angular.isFunction(t)&&(n.push(t),e.$on("$destroy",function(){r.removeListener(t)}))},this.removeListener=function(e){angular.forEach(n,function(t,r){t===e&&n.splice(r,1)})},this.callListeners=function(){var e=this;angular.forEach(n,function(t){t(e.filters)})}}return new n}function MenuManagerProvider(){function e(e){var t=null;return angular.forEach(n.tabs,function(n){e===n.state&&(t=n)}),t}function t(e){n.activeTab&&(n.lastTab=n.activeTab,n.activeTab.active=!1),e.active=!0,n.activeTab=e}var n=this;this.tabs=[],this.activeTab=null,this.lastTab=null,this.addTab=function(e){return this.tabs.push(e),this},this.$get=["$rootScope","$state",function(r){return r.$on("$stateChangeStart",function(n,r,o,a){if(""===a.name){var i=e(r.name);i&&t(i)}}),r.$on("$stateChangeError",function(){t(n.lastTab)}),{tabs:n.tabs,selectTab:t}}]}function EvMenuDirective(e){return{restrict:"E",replace:!0,template:'<ul class="lisette-module-tabs nav nav-tabs" ng-cloak><li ng-repeat="tab in tabs" ng-class="{active: tab.active}"><a ng-click="selectTab(tab)">{{ tab.name }}</a></li></ul>',controller:["$scope","$state",function(t,n){t.tabs=e.tabs,t.selectTab=function(t){e.selectTab(t),n.go(t.state)}}]}}function AjaxStorage(e,t,n,r){function o(n){if(n.cache){var o=JSON.stringify(n),i=a.get(o);if(i)return i}n.id=Fanny.Utils.generateId("proxy:request:");var l={url:"/backoffice/common/xhr",method:"POST",responseType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:n},c=e(l).then(function(e){return e.data.success?e.data.result[n.id].data:(r.warn(e.data.error,e.data.errors),t.reject(e.data.result[n.id]))});return n.cache&&a.put(o,c),c}var a=n("customHttpCache");return{launchRequest:o}}function Storage(e){return{get:function(t){return e.launchRequest(t)}}}var commonModule=angular.module("ev-fdm",["ui.router","ui.date","chieffancypants.loadingBar","ui.bootstrap.tooltip","ui.select2","angularMoment","ngAnimate","checklist-model","ui.bootstrap","restangular"]);commonModule.config(["cfpLoadingBarProvider",function(e){e.includeSpinner=!1,e.parentSelector="#lisette-menu"}]),commonModule.config(["$tooltipProvider",function(e){e.options({placement:"bottom",popupDelay:100})}]),commonModule.config(["$stateProvider",function(e){e.state("ev-error",{templateUrl:"ev-error.phtml"})}]),commonModule.config(["RestangularProvider",function(){}]),commonModule.run(["$rootScope","$state","$location","uiSelect2Config",function(e,t,n,r){r.minimumResultsForSearch=7,r.allowClear=!0,window.moment.lang([window.navigator.language,"en"])}]),angular.module("ev-fdm").factory("ListController",["$state","$stateParams","Restangular",function(e,t,n){function r(r,o,a,i,l){var c=this;this.$scope=r,this.elementName=o,this.elements=a,this.defaultSortKey=i,this.defaultReverseSort=l,this.sortKey=this.defaultSortKey,this.reverseSort=this.defaultReverseSort,this.updateScope(),this.$scope.changePage=function(e){c.update(e,c.filters,c.sortKey,c.reverseSort)},this.$scope.sortChanged=function(){c.sortKey=c.$scope.sortKey,c.reverseSort=c.$scope.reverseSort,c.update(1,c.filters,c.sortKey,c.reverseSort)},this.$scope.toggleDetailView=function(r){if(!r)return void e.go(c.elementName);var o=n.configuration.getIdFromElem(r);o&&t.id!==o?e.go(c.elementName+".view",{id:o}):e.go(c.elementName)},this.$scope.$on("common::filters.changed",function(e,t){c.filters=t,c.sortKey=c.defaultSortKey,c.defaultReverseSort=c.defaultReverseSort,c.update(1,c.filters,c.sortKey,c.reverseSort)}),this.$scope.$on("$stateChangeSuccess",function(e,t){t.name===c.elementName&&(c.$scope.activeElement=null)}),this.$scope.$on(this.elementName+"::updated",function(){c.update(c.$scope.currentPage,c.filters,c.sortKey,c.reverseSort)}),this.$scope.$on(this.elementName+"::created",function(){c.update(c.$scope.currentPage,c.filters,c.sortKey,c.reverseSort)}),this.$scope.$on(this.elementName+"::deleted",function(){c.update(c.$scope.currentPage,c.filters,c.sortKey,c.reverseSort)})}return r.prototype.update=function(e,t,n,r){var o=this;o.fetch(e,t,n,r).then(function(e){o.elements=e,o.updateScope()})},r.prototype.updateScope=function(){var t=this;this.$scope[this.elementName]=this.elements,this.$scope.currentPage=this.elements.pagination.current_page,this.$scope.pageCount=this.elements.pagination.total_pages,this.$scope.sortKey=this.sortKey,this.$scope.reverseSort=this.reverseSort,this.$scope.selectedElements=[],this.$scope.activeElement=null,angular.isDefined(e.params.id)&&angular.forEach(this.elements,function(r){var o=n.configuration.getIdFromElem(r);o===e.params.id&&(t.$scope.activeElement=r)})},r}]);var NotificationsController=["$scope","NotificationsService",function(e,t){e.notifications=t.list,e.$watch(function(){return t.activeNotification},function(){e.activeNotification=t.activeNotification}),e.getClass=function(e){if(!e)return"";switch(e.type){case t.type.ERROR:return"danger";case t.type.SUCCESS:return"success";case t.type.WARNING:return"warning";case t.type.INFO:return"info";default:return"success"}},e.remove=function(e){t.remove(e)}}];angular.module("ev-fdm").controller("NotificationsController",NotificationsController),angular.module("ev-fdm").factory("SearchController",["$rootScope",function(e){function t(t){var n=this;this.$scope=t,this.$scope.filters={},this.$scope.filtersChanged=function(){e.$broadcast("common::filters.changed",n.$scope.filters)}}return t}]),angular.module("ev-fdm").factory("FilterService",["$rootScope","$timeout",FilterServiceFactory]),angular.module("ev-fdm").factory("Select2Configuration",["$timeout",function(e){return function(t,n,r,o){var a,i="";return{minimumInputLength:angular.isDefined(o)&&angular.isNumber(o)?o:3,allowClear:!0,query:function(n){var o=i===n.term?0:600;i=n.term,a&&e.cancel(a),a=e(function(){t(n.term,n.page).then(function(e){var t=[];r&&angular.forEach(e,function(e){t.push(r(e))});var o={results:t.length?t:e};e.pagination&&e.pagination.current_page<e.pagination.total_pages&&(o.more=!0),n.callback(o)})},o)},formatResult:function(e){return n(e)},formatSelection:function(e){return n(e)},initSelection:function(){return{}}}}}]),angular.module("ev-fdm").directive("activableSet",function(){return{restrict:"A",controller:["$scope","$attrs","$parse",function(e,t,n){this.activeElement;var r=n(t.activeElement),o=r.assign,a=this;e.$watch(function(){return r(e)},function(e){a.activeElement=e}),this.toggleActive=function(n){n!==this.activeElement?(o&&o(e,n),this.activeElement=n):(o&&o(e,null),this.activeElement=void 0),e.$eval(t.activeChange)}}]}}).directive("activable",function(){return{restrict:"A",require:"^activableSet",link:function(e,t,n,r){t.addClass("clickable");var o=e[n.activable];e.$watch(function(){return r.activeElement},function(e){e&&o===e?t.addClass("active"):t.removeClass("active")}),t.on("click",function(t){$(t.target).closest(".block-active").length||t.ctrlKey||t.shiftKey||e.$apply(function(){r.toggleActive(o)})})}}});var module=angular.module("ev-fdm");module.directive("clearable",[function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,r){var o=angular.element('<button class="clear" ng-click="clear()">×</button>');t.after(o),o.on("click",function(){e.$apply(function(){t.val(""),r.$setViewValue("")})}),e.$watch(function(){return r.$isEmpty(r.$viewValue)},function(e){e?o.hide():o.show()})}}}]),angular.module("ev-fdm").directive("evDatepicker",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,r){var o="false"!==n.futurAllowed,a=n.dateFormat||"dd/mm/yy";$(function(){t.datepicker({dateFormat:a,maxDate:o?null:0,onSelect:function(t){r.$setViewValue(t),e.$apply()}})})}}}),angular.module("ev-fdm").directive("download",["$http","$location","$document",function(e,t,n){var r=null;return{link:function(t,o,a){o.on("click",function(){e.get(a.download).success(function(e){r||(r=n[0].createElement("iframe"),r.style.display="none",n[0].body.appendChild(r)),r.src=e.url})})}}}]),angular.module("ev-fdm").directive("ngEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.ngEnter)}),t.preventDefault())})}}),angular.module("ev-fdm").provider("menuManager",[MenuManagerProvider]).directive("evMenu",["menuManager",EvMenuDirective]);var module=angular.module("ev-fdm");module.directive("evFilters",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"filters.phtml"}}),angular.module("ev-fdm").directive("evFixedHeaders",["$timeout",function(e){function t(e){var t=e.find("thead > tr"),n=e.find("tbody > tr").first();if(t.length){if(!n.length)return t.addClass("uniform"),void r(t,e.outerWidth());t.removeClass("uniform");var o=0,a=t.find("th");a.each(function(){var e=n.find("td:nth-child("+(1+o)+")");e.is(":visible")?($(this).css("width",e.outerWidth()).show(),$(this).css("maxWidth",e.outerWidth()).show()):$(this).hide(),o++})}}function n(n){e(function(){t(n)},0,!1)}function r(e,t){var n=e.find("th");n.length&&n.each(function(){$(this).css("width",t/n.length+"px")})}return{restrict:"A",replace:!1,scope:{rows:"="},link:function(e,r){var o=$(r);o.addClass("fixed-headers"),$(window).on("resize",function(){t(o)}),e.$on("module-layout-changed",function(){t(o)}),e.$watch("rows",function(){n(o)},!0),n(o)}}}]);var module=angular.module("ev-fdm").directive("evFlag",function(){return{restrict:"E",replace:!0,scope:{lang:"="},template:'<i class="icon icon-flag flag-{{lang}}"></i>'}});angular.module("ev-fdm").directive("focus",[function(){return{link:function(e,t){e.$evalAsync(function(){t[0].focus()})}}}]),angular.module("ev-fdm").directive("linkDisabled",function(){return{restrict:"A",link:function(e,t,n){var r=n.ngClick;r&&e.$watch(n.linkDisabled,function(o,a){o?(t.unbind("click"),t.attr("disabled","disabled")):a&&(n.$set("ngClick",r),t.bind("click",function(){e.$apply(n.ngClick)}),t.removeAttr("disabled"))})}}});var module=angular.module("ev-fdm").directive("evLoadingDots",function(){return{restrict:"E",replace:!0,template:'<span class="loading-dots"><span></span><span></span><span></span></span>'}});angular.module("ev-fdm").directive("evModule",["$timeout","$rootScope",function(e,t){function n(e){return function(){angular.forEach(r,function(t,n){var r=e.find(".lisette-module-"+n),o="has-"+n;e.removeClass(_(t.versions).map(function(e){return n+"-"+e}).join(" ")),r.length?(e.addClass(o),angular.forEach(t.versions,function(t){r.hasClass("version-"+t)&&e.addClass(n+"-"+t)})):e.removeClass(o)}),t.$broadcast("module-layout-changed")}}var r={tabs:{versions:[]},topbar:{versions:["size-mini","size-default","size-big"]},leftbar:{versions:[]},bottombar:{versions:[]}};return{restrict:"A",link:function(t,r){r.addClass("lisette-module"),t.$on("$stateChangeSuccess",function(){e(n(r),0)}),e(n(r),0)}}}]),angular.module("ev-fdm").directive("evModuleHeader",["$timeout",function(e){function t(e){var t=e.find(".lisette-module-header");e.height(t.height()-1),t.affix({offset:{top:1}})}return function(n,r){var o=$(r);e(function(){t(o)},0,!1),$(window).on("resize",function(){t(o)}),n.$on("itemsLoaded",function(){t(o)})}}]),angular.module("ev-fdm").directive("mouseFollower",["$document",function(e){return{restrict:"A",link:function(t,n){n=angular.element(n),n.css("position","absolute"),n.css("z-index",1500),e.on("mousemove",function(e){n.css({left:e.pageX,top:e.pageY})})}}}]);var module=angular.module("ev-fdm").directive("evPagination",[function(){var e="...";return{restrict:"AE",replace:!0,templateUrl:"pagination.phtml",scope:{currPage:"=",nbPage:"=",onPageChange:"="},link:function(t){t.paginationButtons=[],t.prevClass="",t.nextClass="",t.currPage||(t.currPage=1),t.nbPage||(t.nbPage=1),t.generateButtons=function(){var n=2;t.paginationButtons=[],t.paginationButtons.push({value:1,"class":1==t.currPage?"active":""}),t.currPage-n>2&&t.paginationButtons.push({value:e,"class":"disabled"});for(var r=n;r>0;r--)t.currPage-r>1&&t.paginationButtons.push({value:t.currPage-r});1!=t.currPage&&t.currPage!=t.nbPage&&t.paginationButtons.push({value:t.currPage,"class":"active"});for(var r=1;n>=r;r++)t.currPage+r<t.nbPage&&t.paginationButtons.push({value:t.currPage+r});t.currPage+n<t.nbPage-1&&t.paginationButtons.push({value:e,"class":"disabled"}),t.nbPage>1&&t.paginationButtons.push({value:t.nbPage,"class":t.currPage==t.nbPage?"active":""})},t.previousPage=function(){t.currPage>1&&(t.currPage--,angular.isFunction(t.onPageChange)&&t.onPageChange(t.currPage))},t.changePage=function(n){n!=e&&n>=1&&n<=t.nbPage&&(t.currPage=n,angular.isFunction(t.onPageChange)&&t.onPageChange(n))},t.nextPage=function(){t.currPage<t.nbPage&&(t.currPage++,angular.isFunction(t.onPageChange)&&t.onPageChange(t.currPage))},t.$watch("nbPage + currPage",function(){t.generateButtons()})}}}]);angular.module("ev-fdm").directive("promise",[function(){function e(e,t){t.removeClass("promise-resolved promise-resolving promise-empty promise-rejected"),t.addClass(e)}return{restrict:"A",replace:!1,controller:["$scope","$attrs","$parse","$element",function(t,n,r,o){var a=r(n.promise),i=n.emptyMessage,l="false"!==n.promiseDefaultStyles;l&&e("promise-default-styles",o),i&&o.append('<div class="promise-empty-message">'+i+"</div>"),t.$watch(function(){return a(t)},function(t){t?(e("promise-resolving",o),t.then(function(t){return i&&angular.isArray(t)&&!t.length?e("promise-resolved promise-empty",o):e("promise-resolved",o),t},function(){e("promise-rejected",o)})):e("promise-resolved",o)})}]}}]),function(){"use strict";angular.module("ev-fdm").directive("evPromiseProgress",[function(){return{restrict:"A",replace:!0,scope:{promise:"=evPromiseProgress"},template:'<div role="progressbar" class="ev-progress" aria-valuemin="0" aria-valuemax="100"aria-valuenow="0"> <div class="ev-progress-overlay"></div> </div> ',link:function(e,t){var n=t.find(angular.element(document.querySelector(".ev-progress-overlay")));n.css({width:"0%"}),e.$watch("promise",function(e){e&&e.then&&(n.css({width:"0%"}),e.then(null,null,function(e){"object"==typeof e&&(e=e.progress),n.css({width:e+"%"})}),e.finally(function(){n.css({width:"100%"})}))})}}}])}(),angular.module("ev-fdm").directive("body",["$rootScope","NotificationsService","$state",function(e,t,n){return{restrict:"E",link:function(r,o){e.$on("$stateChangeStart",function(e,t){var r=n.current.name.indexOf("."),o=-1!=r?n.current.name.substring(0,r):n.current.name;o&&0===t.name.indexOf(o)||$("body").addClass("state-resolving")}),e.$on("$stateChangeSuccess",function(){o.removeClass("state-resolving")}),e.$on("$stateChangeError",function(){$("body").removeClass("state-resolving");var e=toState.fallback&&toState.fallback.message||"Error";t.addError({text:e}),toState&&toState.fallback&&toState.fallback.state&&n.go(toState.fallback.state)})}}}]),angular.module("ev-fdm").provider("evSelectLanguage",function(){this.$get=function(){return{availableLang:this.availableLang||[],defaultLang:this.defaultLang}},this.setAvailableLang=function(e){this.availableLang=e},this.setDefaultLang=function(e){this.defaultLang=e}}).directive("evSelectLanguage",["evSelectLanguage",function(e){return{template:'<div class="ev-language-tabs"><div class="btn-group"><button class="btn btn-lg btn-default" ng-repeat="lang in availableLang"ng-class="{active: selectedLang===lang}"ng-click="$parent.selectedLang=lang"><span class="ev-icons-flags" ng-class="\'icon-\' + lang"></span></button></div></div>',restrict:"AE",scope:{selectedLang:"=lang"},link:function(t){t.availableLang=e.availableLang,t.selectedLang||(t.selectedLang=e.defaultLang)}}}]),angular.module("ev-fdm").directive("selectableSet",[function(){return{restrict:"A",controller:["$scope","$parse","$element","$attrs","$document",function(e,t,n,r,o){function a(e,t){var n,r,o=i(t),a=Math.min(e,t),u=Math.max(e,t);if(angular.forEach(m,function(e){c(e)}),s.isElementSelected(o)){for(r=a;u>=r;r++)n=i(r),c(n);f=t,m.length=0}else for(m.length=0,r=a;u>=r;r++)n=i(r),l(n),m.push(n)}function i(e){return s.selectableElements[e]}function l(e){s.isElementSelected(e)||s.selectedElements.push(e)}function c(e){var t=s.selectedElements.indexOf(e);t>-1&&s.selectedElements.splice(t,1)}var s=this,u=16,d=t(r.selectedElements);this.selectableElements=[],this.selectedElement=[];var f,m=[];e.$watch(function(){return d(e)},function(){s.selectedElements=angular.isArray(d(e))?d(e):[]}),o.on("keydown",function(e){e.keyCode===u&&n.addClass("noselect")}),o.on("keyup",function(e){e.keyCode===u&&n.removeClass("noselect")}),this.toggleSelection=function(e,t){f=t,m.length=0,this.isElementSelected(e)?c(e):l(e)},this.toggleSelectAll=function(){this.selectedElements.length===this.selectableElements.length?this.selectedElements.length=0:angular.forEach(this.selectableElements,function(e){s.isElementSelected(e)||l(e)})},this.shiftedClick=function(e,t){void 0!==typeof f&&a(f,t)},this.registerElement=function(e){this.selectableElements.push(e)},this.unregisterElement=function(e){var t=this.selectableElements.indexOf(e);t>-1&&this.selectableElements.splice(t,1),t=this.selectedElements.indexOf(e),t>-1&&this.selectedElements.splice(t,1)},this.areAllElementSelected=function(){return this.selectedElements.length===this.selectableElements.length&&0!==this.selectedElements.length},this.isElementSelected=function(e){return s.selectedElements.indexOf(e)>-1}}]}}]).directive("selectable",["$parse",function(e){return{restrict:"A",require:"^selectableSet",link:function(t,n,r,o){function a(e){e.shiftKey?o.shiftedClick(l,t.$index):(e.ctrlKey||angular.element(e.target).is(".checkbox"))&&o.toggleSelection(l,t.$index)}var i=e(r.selectable),l=i(t);o.registerElement(l),t.$on("$destroy",function(){o.unregisterElement(l)}),t.$watch(function(){return o.isElementSelected(l)},function(){t.selected=o.isElementSelected(l)}),n.on("click",function(e){t.$apply(function(){a(e)})})}}}]).directive("selectBox",function(){return{restrict:"E",require:"^selectable",replace:!0,template:'<span class="checkbox" ng-class="{ active: selected }"></span>'}}).directive("selectAll",function(){return{restrict:"E",require:"^selectableSet",scope:!0,template:'<span class="checkbox" ng-class="{ active: allSelected }" ng-click="toggleSelectAll()"></span>',link:function(e,t,n,r){e.toggleSelectAll=function(){r.toggleSelectAll()},e.$watchCollection(function(){return r.areAllElementSelected()},function(){e.allSelected=r.areAllElementSelected()})}}}),angular.module("ev-fdm").directive("sortableSet",function(){return{restrict:"A",controller:["$scope","$parse","$element","$attrs",function(e,t,n,r){var o=this;this.reverseSort=!1,this.sortKey="",e.reverseSort=e.reverseSort||!1;var a=t(r.reverseSort),i=a.assign,l=t(r.sortBy),c=l.assign;e.$watch(function(){return a(e)},function(e){o.reverseSort=e}),e.$watch(function(){return l(e)},function(e){o.sortKey=e}),this.sortBy=function(t){t==this.sortKey?this.reverseSort=!this.reverseSort:(this.reverseSort=!1,this.sortKey=t),i&&i(e,this.reverseSort),c&&c(e,this.sortKey),e.$eval(r.sortChange)}}]}}).directive("sortable",function(){return{restrict:"A",require:"^sortableSet",link:function(e,t,n,r){function o(){r.sortKey===a?(t.removeClass("no-sort"),r.reverseSort?t.removeClass("sort-down").addClass("sort-up"):t.removeClass("sort-up").addClass("sort-down")):t.removeClass("sort-up sort-down").addClass("no-sort")}var a=n.sortable;t.addClass("sortable sort"),e.$watch(function(){return r.sortKey},function(){o()}),e.$watch(function(){return r.reverseSort},function(){o()}),t.on("click",function(){e.$apply(function(){r.sortBy(a)})})}}});var module=angular.module("ev-fdm");module.directive("throttle",["$timeout",function(e){return{restrict:"A",require:"ngModel",priority:1,link:function(t,n,r,o){var a=o.$setViewValue,i=angular.copy(o.$viewChangeListeners);o.$viewChangeListeners=[];var l;o.$setViewValue=function(t){var n=o.$modelValue!==t;a.apply(o,[t]),n&&(l&&e.cancel(l),l=e(function(){angular.forEach(i,function(e){try{e()}catch(t){$exceptionHandler(t)}})},600))}}}}]),angular.module("ev-fdm").directive("evValue",function(){return{restrict:"E",replace:!0,scope:{value:"=",noValue:"@"},templateUrl:"value.phtml"}}),"undefined"==typeof Fanny&&(Fanny={}),Fanny.Utils={generatedIds:{},generateId:function(e){var t=e+1e4*Math.random();return this.generatedIds[t]=!0,t},convertNumberToString:function(e,t,n){var r=" ",o=",",a="",i=[],l="",c="",s="";if("undefined"==typeof t&&(t=2),a=e+"",i=a.split("."),i.length<1&&i.length>2)throw new Error("Invalid number");if(l=i[0],1==i.length){c="";for(var u=0;t>u;u++)c+="0"}else if(c=i[1],c.length>t)c=c.substring(0,2);else for(;c.length<t;)c+="0";for(var u=0;u<l.length;u++)u%3==0&&0!=u&&(s=r+s),s=l[l.length-u-1]+s;""==s&&(s="0");for(var u=s.length;n>u;u++)s="0"+s;return c.length>0&&(s+=o+c),s},stringToVar:function(e){if("string"!=typeof e)throw new Error("Not a string");if(!isNaN(e))return parseInt(e);for(var t=e.split("."),n=window,r=0;r<t.length;r++){if(!t[r].length||"undefined"==typeof n[t[r]])throw new Error("No corresponding var found for "+e);n=n[t[r]]}return n},formatDate:function(e){if(!e||"object"!=typeof e)return"";var t=e.getFullYear(),n=this.convertNumberToString(e.getMonth()+1,0,2),r=this.convertNumberToString(e.getDate(),0,2);return t+"-"+n+"-"+r},Renderers:{date:function(e){var t=null,n=null;return t=e&&"object"==typeof e?e.date:e,"string"==typeof t&&t?(t=t.split(" ")[0],n=t.split("-"),3===n.length?n[2]+"/"+n[1]+"/"+n[0]:""):""},amounts:function(e){var t=Fanny.Utils.convertNumberToString(e,2);return e>=0?t:$("<span>").addClass("text-orange").html(t)},money:function(e,t){var n=t&&t.currency&&t.currency.symbole?t.currency.symbole:"€",r=Fanny.Utils.convertNumberToString(e,2)+" "+n;return e>=0?r:$("<span>").addClass("text-orange").html(r)},euros:function(e){var t=Fanny.Utils.convertNumberToString(e,2)+" €";return e>=0?t:$("<span>").addClass("text-orange").html(t)},upper:function(e){return"string"==typeof e?e.toUpperCase():e}}},angular.module("ev-fdm").filter("cleanupDate",function(){return function(e){var t="";if(e){var n=e.slice(0,4),r=e.slice(5,7),o=e.slice(8,10);t=o+"/"+r+"/"+n}return t}}),angular.module("ev-fdm").filter("cssify",function(){return function(e,t){var n="";if(t)for(var r in t)if(t.hasOwnProperty(r)&&e==r){n=t[r];break}return n}}),angular.module("ev-fdm").filter("unsafe",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),angular.module("ev-fdm").service("FilteringService",["$location",function(){var e={};return{setSelectedFilter:function(t,n){e[t]=void 0!=n&&"undefined"!=n?n:""},getSelectedFilter:function(t){var n="";return"undefined"!=typeof e[t]&&"undefined"!=e[t]&&(n=e[t]),n},getAllFilters:function(){return e}}}]);var module=angular.module("ev-fdm"),ModalService=function(e,t,n,r){this.$rootScope=e,this.$templateCache=t,this.$compile=n,this.$controller=r};ModalService.prototype.open=function(e){e=this._readOptions(e);var t=(e.parentScope||this.$rootScope).$new();t=_(t).extend(e.scope);var n;e.controller&&(n=this.$controller(e.controller,{$scope:t}));var r=this.$compile(e.template||this.$templateCache.get(e.templateUrl))(t);return r.$scope=t,r.$controller=n,n&&(n.$modal=r),$(r).modal(e)},ModalService.prototype._readOptions=function(e){if(e=_({backdrop:!0,scope:{},keyboard:!0}).extend(e),!e.templateUrl&&!e.template)throw new Error("Either template or templateUrl have to be defined");return e},module.service("ModalService",["$rootScope","$templateCache","$compile","$controller",ModalService]);var module=angular.module("ev-fdm");module.service("NotificationsService",["$timeout",function(e){function t(e){e.type||(e.type=c.SUCCESS),o(e)}function n(e){i=_(i).without(e),r()}function r(){if(i.length){var t=i[0];a.activeNotification!==t&&(a.activeNotification=t,-1!==t.delay&&e(function(){n(t)},1e3*(t.delay||l)))}else a.activeNotification=null}function o(e){i.push(e),r()}var a=this,i=[],l=5,c={SUCCESS:0,ERROR:1,INFO:2,WARNING:3};this.activeNotification=null,this.add=t,this.remove=n,this.addError=function(e){e.type=c.ERROR,t(e)},this.addSuccess=function(e){e.type=c.SUCCESS,t(e)},this.type=c}]);var module=angular.module("ev-fdm");module.factory("panelFactory",function(){var e=function(e){this.blockers=[],_(this).extend(e)};return e.prototype.addBlocker=function(e){this.blockers.push(e)},e.prototype.removeBlocker=function(e){this.blockers=_(this.blockers).without(e)},e.prototype.isBlocked=function(e){return _(this.blockers).some(function(t){return t(e)})},{create:function(t){return new e(t)}}}),module.factory("sidonieRegion",function(){function e(e){return function(){throw new Error("Method "+e+" should be overriden")}}var t=function(e){this.hasPush=e,this.panels=_([])};return t.prototype.open=e("open"),t.prototype.close=e("close"),t.prototype.push=function(e){this.panels.push(e)},t.prototype.remove=function(e){var t=this.panels.indexOf(e);return t>-1&&this.panels.splice(t,1),t},t.prototype.at=function(e){return this.panels._wrapped[e]},t.prototype.each=function(){return this.panels.each.apply(this.panels,arguments)},t.prototype.dismissAll=function(e){this.each(function(t){t.dismiss(e)})},t.prototype.last=function(){return this.panels.last()},t.prototype.getNext=function(e){var t=this.panels.indexOf(e);return t<this.panels.size()-1?this.at(t+1):null},t.prototype.getChildren=function(e){var t=this.panels.indexOf(e);return t>-1?this.panels.slice(t+1):[]},t.prototype.size=function(){return this.panels.size()},t.prototype.isEmpty=function(){return 0===this.panels.size()},{create:function(e,n){var r=function(e){return t.call(this,e)};return r.prototype=_({}).extend(t.prototype,n),new r(e)}}}),module.service("PanelService",["$rootScope","$http","$templateCache","$q","$injector","$controller","middleRegion","rightRegion","panelFactory",function(e,t,n,r,o,a,i,l,c){function s(e,t){if(!t.template&&!t.templateUrl&&!t.content)throw new Error("Should define options.template or templateUrl or content");return t.push=t.push||t.pushFrom,t.panelClass=t.panelClass||"",t.panelClass+=" "+e,t.resolve=t.resolve||{},t}function u(e){return e.content?r.when(e.content):e.template?r.when(e.template):t.get(e.templateUrl,{cache:n}).then(function(e){return e.data})}function d(e){var t=[];return angular.forEach(e,function(e){(angular.isFunction(e)||angular.isArray(e))&&t.push(r.when(o.invoke(e)))}),t}function f(e){return[u(e)].concat(d(e.resolve))}function m(e){return r.all(f(e)).then(function(t){var n={},r=1;return angular.forEach(e.resolve,function(e,o){n[o]=t[r++]}),{content:t[0],locals:n}})}function p(e){if(_($).has(e))return $[e];throw new Error("Unknown region "+e)}function g(e,t,n){for(var r=e.getChildren(t),o=r.length-1;o>=0;o--){var a=r[o],i=a.dismiss(n);if(!i)return!1}return!0}function v(t,n){var o=r.defer(),i=r.defer(),l=c.create({result:o.promise,opened:i.promise,close:function(e){if(!l.isBlocked()){var r=g(t,l,"parent closed");return r?(t.close(l,n),t.remove(l),o.resolve(e),!0):!1}return!1},dismiss:function(e){if(!l.isBlocked()){var r=g(t,l,"parent dismissed");return r?(t.close(l,n),t.remove(l),o.reject(e),!0):!1}return!1}});return m(n).then(function(r){var i=(n.scope||e).$new();i.$close=l.close,i.$dismiss=l.dismiss;var c;if(n.controller){var s=r.locals;s.$scope=i,s.$instance=l,c=a(n.controller,s)}n.scope=i,n.deferred=o,n.content=r.content,n.replace?(t.replace(n.replace,l,n),t.remove(n.replace,n)):t.open(l,n)}).then(function(){i.resolve(!0)},function(){i.resolve(!1)}),l}var h=1,$={middle:i,right:l};return{open:function(e,t){t=s(e,t);var n,r=p(e),o=r.last();if(t.push&&!t.pushFrom&&(t.pushFrom=o),t.pushFrom&&t.pushFrom!=o&&(t.replace=r.getNext(t.pushFrom),t.replace)){var a=g(r,t.replace,"parent replaced");if(!a)return!1}return r.hasPush&&t.push||r.isEmpty()||(t.replace=o),t.replace&&t.replace.isBlocked()?!1:(n=v(r,t),n.$$id=h++,n.$$region=e,r.push(n),n)},push:function(e,t){return t.push=!0,this.open(e,t)},dismissAll:function(e){_($).each(function(t){t.dismissAll(e)})},dismissChildren:function(e,t){var n=$[e.$$region];return g(n,e,t)}}}]);var module=angular.module("ev-fdm"),SidonieModalService=function(e,t,n){function r(t,r,o){var a=i(t),s=a.multi,u=a.opened;if(o.windowClass||(o.windowClass=" fade "),o.windowClass+=" "+t,o.templateUrl||o.template||(o.templateUrl=r+".phtml"),o.backdrop=t==SidonieModalService.REGION_MIDDLE,s)throw new Error("Multi not implemented yet");if(u.length){var d=u[u.length-1];if(d.status==SidonieModalService.STATUS_LOCKED)return n.warn("Open modal aborted due to "+d.sidonieModalType+"'s locked status"),c(d),!1;if(d.sidonieModalType!=r){d.modal("hide");var f=e.open(o);return f.sidonieModalType=r,f.result.finally(l(t,f)),a.opened=[f],f}return d}var f=e.open(o);return f.sidonieModalType=r,f.result.finally(l(t,f)),a.opened=[f],f}function o(){var e=!1;return angular.forEach(s,function(t){angular.forEach(t.opened,function(t){e||t.status==SidonieModalService.STATUS_LOCKED&&(c(t),n.warn("Open modal aborted due to "+t.sidonieModalType+"'s locked status"),e=t)})}),e?e:(angular.forEach(s,function(e){angular.forEach(e.opened,function(e){try{e.close()}catch(t){}})}),!0)}function a(e,t){var n=i(e);if(n.modals.length){var r=n.modals[n.modals.length-1];return t&&r.sidonieModalType!=t?!1:r}}function i(e){var t=s[e];if("undefined"==typeof t)throw new Error("Unknown region "+e);return t}function l(e,t){return function(){var n=i(e);angular.forEach(n.opened,function(e){t==e&&(n.opened=_(n.opened).without(t))})}}function c(e){t.addClass(e,"modal-locked",function(){t.removeClass(e,"modal-locked")})}var s={};return s[SidonieModalService.REGION_RIGHT]={multi:!1,opened:[]},s[SidonieModalService.REGION_MIDDLE]={multi:!1,opened:[]},{open:r,openRight:function(e,t){r(SidonieModalService.REGION_RIGHT,e,t)},openMiddle:function(e,t){r(SidonieModalService.REGION_MIDDLE,e,t)},get:a,closeAll:o}};SidonieModalService.STATUS_LOCKED="locked",SidonieModalService.REGION_RIGHT="right",SidonieModalService.REGION_MIDDLE="middle",module.service("SidonieModalService",["$modal","$animate","$log",SidonieModalService]);var module=angular.module("ev-fdm");module.service("SortService",[function(){var e="",t=!1,n=function(){return e},r=function(n){return n==e?t=!t:e=n,this},o=function(n){var r="sort ";return r+=n==e?t?"sort-up":"sort-down":"no-sort"},a=function(e){t=e},t=function(){return t};return{sortBy:r,getSortCSS:o,getCurrentSort:n,setReverse:a,isReverse:t}}]);var module=angular.module("ev-fdm"),AbstractAutocompleteStorage=function(e,t){_.extend(this,e),this.AbstractStorage=e,this.$timeout=t};AbstractAutocompleteStorage.prototype.generateAutocompleteConfig=function(e,t,n){var r,o=this;return{minimumInputLength:n,allowClear:!0,initSelection:function(){return""},query:function(n){var a=n.term;r&&o.$timeout.cancel(r),r=o.$timeout(function(){e.call(o,a.toUpperCase()).then(function(e){var r=t(e);n.callback({results:r})})},600)}}},module.service("AbstractAutocompleteStorage",["Storage","$timeout",AbstractAutocompleteStorage]),angular.module("ev-fdm").service("AjaxStorage",["$http","$q","$cacheFactory","$log",AjaxStorage]),angular.module("ev-fdm").factory("RestangularStorage",["Restangular",function(e){function t(t,n){this.restangular=e,this.resourceName=t,this.defaultEmbed=n||[]}return t.buildSortBy=function(e,t){var n=t?"DESC":"ASC";return e+":"+n},t.buildEmbed=function(e){return e.join(",")},t.buildFilters=function(e){var t={};return angular.forEach(e,function(e,n){angular.isObject(e)&&angular.isDefined(e.uuid)?t[n+".uuid"]=e.uuid:angular.isObject(e)&&angular.isDefined(e.id)?t[n+".id"]=e.id:angular.isArray(e)&&e.length>0?t[n]=e.join(","):angular.isDate(e)?t[n]=e.toISOString():angular.isDefined(e)&&""!==e&&null!==e&&(t[n]=e)}),t},t.prototype.getList=function(e,n,r,o,a){var i={};return angular.isNumber(e)&&e>0&&(i.page=e),angular.isArray(n)&&n.length?i.embed=t.buildEmbed(n.concat(this.defaultEmbed)):this.defaultEmbed.length&&(i.embed=t.buildEmbed(this.defaultEmbed)),o&&(i.sortBy=t.buildSortBy(o,a)),r&&(r=t.buildFilters(r),angular.extend(i,r)),this.restangular.all(this.resourceName).getList(i)
},t.prototype.getById=function(e,n){var r={};return angular.isArray(n)&&n.length?r.embed=t.buildEmbed(n.concat(this.defaultEmbed)):this.defaultEmbed.length&&(r.embed=t.buildEmbed(this.defaultEmbed)),this.restangular.one(this.resourceName,e).get(r)},t.prototype.update=function(e,n){var r={};return angular.isArray(n)&&n.length?r.embed=t.buildEmbed(n.concat(this.defaultEmbed)):this.defaultEmbed.length&&(r.embed=t.buildEmbed(this.defaultEmbed)),e.put(r)},t}]);var module=angular.module("ev-fdm");module.service("Storage",["AjaxStorage",Storage]);var angularLocalStorage=angular.module("LocalStorageModule",[]);angularLocalStorage.value("prefix","ls"),angularLocalStorage.constant("cookie",{expiry:30,path:"/"}),angularLocalStorage.constant("notify",{setItem:!0,removeItem:!1}),angularLocalStorage.service("localStorageService",["$rootScope","prefix","cookie","notify",function(e,t,n,r){"."!==t.substr(-1)&&(t=t?t+".":"");var o=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.message),!1}},a=function(n,a){if(!o())return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),r.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:n,newvalue:a,storageType:"cookie"}),d(n,a);"undefined"==typeof a&&(a=null);try{(angular.isObject(a)||angular.isArray(a))&&(a=angular.toJson(a)),localStorage.setItem(t+n,a),r.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:n,newvalue:a,storageType:"localStorage"})}catch(i){return e.$broadcast("LocalStorageModule.notification.error",i.message),d(n,a)}return!0},i=function(n){if(!o())return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),f(n);var r=localStorage.getItem(t+n);return r?"{"===r.charAt(0)||"["===r.charAt(0)?angular.fromJson(r):r:null},l=function(n){if(!o())return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),r.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:n,storageType:"cookie"}),m(n);try{localStorage.removeItem(t+n),r.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:n,storageType:"localStorage"})}catch(a){return e.$broadcast("LocalStorageModule.notification.error",a.message),m(n)}return!0},c=function(){if(!o())return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;var n=t.length,r=[];for(var a in localStorage)if(a.substr(0,n)===t)try{r.push(a.substr(n))}catch(i){return e.$broadcast("LocalStorageModule.notification.error",i.Description),[]}return r},s=function(){if(!o())return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),p();var n=t.length;for(var r in localStorage)if(r.substr(0,n)===t)try{l(r.substr(n))}catch(a){return e.$broadcast("LocalStorageModule.notification.error",a.message),p()}return!0},u=function(){try{return navigator.cookieEnabled||"cookie"in document&&(document.cookie.length>0||(document.cookie="test").indexOf.call(document.cookie,"test")>-1)}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.message),!1}},d=function(r,o){if("undefined"==typeof o)return!1;if(!u())return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var a="",i=new Date;null===o&&(n.expiry=-1,o=""),0!==n.expiry&&(i.setTime(i.getTime()+24*n.expiry*60*60*1e3),a="; expires="+i.toGMTString()),r&&(document.cookie=t+r+"="+encodeURIComponent(o)+a+"; path="+n.path)}catch(l){return e.$broadcast("LocalStorageModule.notification.error",l.message),!1}return!0},f=function(n){if(!u())return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var r=document.cookie.split(";"),o=0;o<r.length;o++){for(var a=r[o];" "==a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(t+n+"="))return decodeURIComponent(a.substring(t.length+n.length+1,a.length))}return null},m=function(e){d(e,null)},p=function(){for(var e=null,n=t.length,r=document.cookie.split(";"),o=0;o<r.length;o++){for(e=r[o];" "==e.charAt(0);)e=e.substring(1,e.length);key=e.substring(n,e.indexOf("=")),m(key)}};return{isSupported:o,set:a,add:a,get:i,keys:c,remove:l,clearAll:s,cookie:{set:d,add:d,get:f,remove:m,clearAll:p}}}]);var module=angular.module("ev-fdm");module.directive("middlePanelBackdrop",["$timeout",function(e){return{restrict:"EA",replace:!0,template:'<div class="modal-backdrop fade" ng-class="{in: animate}" ng-style="{\'z-index\': 1040 + index*10}"></div>',link:function(t){t.animate=!1,e(function(){t.animate=!0})}}}]),module.directive("middlePanelWindow",["$timeout","middleRegion",function(e,t){return{restrict:"EA",scope:{index:"@"},replace:!0,transclude:!0,templateUrl:"panels/middle-window.phtml",link:function(n,r){e(function(){n.animate=!0,r[0].focus()}),n.close=function(e){e.target===e.currentTarget&&(e.preventDefault(),e.stopPropagation(),t.dismissAll())}}}}]),module.service("middleRegion",["$compile","$document","$rootScope","sidonieRegion",function(e,t,n,r){var o={},a=t.find("body").eq(0),i=r.create(!1,{open:function(t,r){var i,l;i=angular.element("<div middle-panel-backdrop></div>"),l=e(i)(n.$new(!0)),a.append(l);var c=angular.element("<div middle-panel-window></div>");c.addClass(r.panelClass),c.html(r.content);var s=e(c)(r.scope);return a.append(s),o[t.$$id]={window:s,backdrop:l},t},replace:function(){throw new Error("Not implemented")},close:function(e){"undefined"!=typeof o[e.$$id]&&(o[e.$$id].window.remove(),o[e.$$id].backdrop.remove(),delete o[e.$$id])}});return t.bind("keydown",function(e){if(27===e.which){var t=i.last();t&&n.$apply(function(){t.dismiss("escape")})}}),i}]);var module=angular.module("ev-fdm");module.directive("rightPanelWindow",["$timeout",function(e){function t(e){var t,n;for(n=0;n<r.length;n++)if(e<r[n]){t=r[n];break}return t?n:-1}function n(e,t){var n="";n=-1==t?"max":r[t],e.attr("data-breakpoint",n)}var r=[100,200,300,400,500,600,700];return{restrict:"A",replace:!0,transclude:!0,templateUrl:"panels/right-window.phtml",link:function(r,o){o.resizable({handles:"w",resize:function(e,r){var a=t(r.size.width);n(o,a)}}),r.$on("animation-complete",function(){var e=t(o.outerWidth());n(o,e)}),e(function(){var e=t(o.outerWidth());n(o,e),o[0].focus()})}}}]),module.service("rightRegion",["$rootScope","$compile","$animate","$timeout","sidonieRegion",function(e,t,n,r,o){function a(e){return u[e.$$id]?u[e.$$id]:null}function i(e,t){var n=f[e.$$depth+"-"+t.panelClass];return n?'style="width: '+n+'px;"':""}function l(e){for(var t=0;t<m.panels.size();t++){var r=e>t,o=m.at(t),i=a(o);o.$$stacked&&!r?(delete o.$$actualWidth,n.removeClass(i,"stacked")):!o.$$stacked&&r&&(o.$$actualWidth=a(o).outerWidth(),n.addClass(i,"stacked")),o.$$stacked=r}}function c(){for(var e=$(window).innerWidth()-100,t=0;t<m.panels.size();t++){var n=0,r=_(m.panels).reduce(function(e,r){if(n++<t)return e+s;var o=a(r);if(!o)return e;if(r.$$stacked)return e+r.$$actualWidth;var i=o.outerWidth();return 50>i?e+300:e+i},0);if(e>r)return l(t)}l(m.panels.size()-1)}var s=15,u={},d=_(c).debounce(50);$(window).on("resize",function(){m.updateStacking()});var f=window.stylesCache={},m=o.create(!0,{updateStacking:function(){return r(d)},open:function(r,o){r.$$depth=m.panels.size();var a=angular.element('<div class="panel-placeholder"></div>'),l=angular.element("<div right-panel-window "+i(r,o)+"></div>");return l.html(o.content),o.scope.panelClass=o.panelClass,l=t(l)(o.scope),a.html(l),u[r.$$id]=a,n.enter(a,$(".lisette-module-region.right"),null,function(){o.scope.$emit("animation-complete"),e.$broadcast("module-layout-changed"),m.updateStacking()}),a.on("resize",function(e,t){f[r.$$depth+"-"+o.panelClass]=t.size.width,m.updateStacking()}),m.updateStacking(),r},replace:function(e,n,r){if("undefined"!=typeof u[e.$$id]){var o=u[e.$$id];n.$$depth=m.panels.size()-1;var a=angular.element("<div right-panel-window "+i(n,r)+"></div>");return a.html(r.content),r.scope.panelClass=r.panelClass,a=t(a)(r.scope),o.html(a),u[n.$$id]=o,delete u[e.$$id],m.updateStacking(),n}return m.open(n,r)},close:function(e){if("undefined"!=typeof u[e.$$id]){var t=u[e.$$id];n.leave(t,function(){delete u[e.$$id],m.updateStacking()}),m.updateStacking()}}});return m}]),angular.module("ev-fdm").directive("disableValidation",function(){return{require:"^form",restrict:"A",link:function(e,t,n,r){var o;e.$watch(n.disableValidation,function(e){o||(o=r[t.attr("name")]),e===!1?(r.$addControl(o),angular.forEach(o.$error,function(e,t){r.$setValidity(t,!e,o)})):r.$removeControl(o)})}}}),angular.module("ev-fdm").directive("strictMin",function(){return{require:"ngModel",link:function(e,t,n,r){function o(e){var t=parseFloat(e),o=parseFloat(n.strictMin);return t>o?(r.$setValidity("strictMin",!0),e):void r.$setValidity("strictMin",!1)}r.$parsers.unshift(o),r.$formatters.push(o)}}});
//# sourceMappingURL=ev-fdm-core.min.js.map
angular.module("ev-leaflet",["leaflet-directive"]).provider("evLeaflet",function(){this.$get=function(){return{icons:this.icons}},this.setIcons=function(e){this.icons=e}}).directive("evLeaflet",["leafletData","evLeaflet","$log",function(e,a,t){return{template:'<leaflet class="ev-leaflet" defaults="defaults" markers="markers" center="center"></leaflet>',restrict:"AE",scope:{coordinate:"=",editable:"="},controller:function(e){function r(){e.center={lat:e.markers.marker.lat,lng:e.markers.marker.lng,zoom:8}}var n={iconSize:[40,40],shadowSize:[1,1],iconAnchor:[1,20]},l=a.icons;"default"in l&&angular.extend(l.default,n),"draggable"in l&&angular.extend(l.draggable,n),e.defaults={scrollWheelZoom:!1,doubleClickZoom:!1},e.markers={marker:{focus:!0}},r(),e.$watch("coordinate.latitude",function(a){isNaN(a)&&(a=0,t.warn("ev-leaflet: latitude is not a number")),e.markers.marker.lat=a,r()}),e.$watch("coordinate.longitude",function(a){isNaN(a)&&(a=0,t.warn("ev-leaflet: longitude is not a number")),e.markers.marker.lng=a,r()}),e.$watch("markers.marker.lat",function(a){e.coordinate.latitude=a}),e.$watch("markers.marker.lng",function(a){e.coordinate.longitude=a}),e.$watch("editable",function(){var a=e.editable;e.markers.marker.icon=a?l.draggable:l["default"],e.markers.marker.draggable=a})}}}]);
//# sourceMappingURL=ev-fdm-leaflet.min.js.map
!function(){"use strict";angular.module("ev-upload",["ev-fdm"])}(),function(){"use strict";angular.module("ev-upload").directive("evPictureUpload",["NotificationsService","$http",function(e,l){return{restrict:"AE",scope:{pictureSuccess:"&newPicture",url:"@"},template:'<ev-upload settings="settings" file-success="pictureSuccess({picture: file})"class="ev-picture-upload" upload="newUpload(promise)"><div ng-hide="uploading"><div class="ev-picture-upload-label">{{ "Faites glisser vos images ici" | i18n }}</div><table style="width:100%"><tr><td style="width:114px"><button type="button" class="btn btn-default ev-upload-clickable">{{ "Importer..." | i18n}}</button></td><td style="width:30px´; line-height: 36px;">{{ "ou" | i18n }}</td><td><form novalidate name="flickr" ng-class="{\'has-error\': flickr.$dirty && flickr.$invalid}"><input name="fUrl" placeholder="{{\'Lien Flickr\' | i18n}}" ng-model="$parent.flickrUrl" ng-pattern="flickrUrlPattern" required="" class="form-control" ng-change="uploadFlickrUrl(flickr)"/><div ng-show="flickr.fUrl.$dirty && flickr.fUrl.$invalid"><p class="control-label" for="fUrl" data-ng-show="flickr.fUrl.$error.pattern">{{ "L\'url doit être une photo flickr" | i18n}}</p></div></form></td></tr></table></div><div class="ev-picture-uploading" ng-show="uploading"><div class="ev-picture-upload-label"> {{"Upload en cours"| i18n}} </div><div class="spinner"></div><p> {{upload.done}} / {{upload.total}} {{ "photo(s) uploadée(s)" | i18n }} </p></div><div ng-show="uploading" ev-promise-progress="uploadPromise"></div></ev-upload>',link:function(e){e.flickrUrlPattern=/^(https\:\/\/)?www\.flickr\.com\/photos\/.*\/\d+.*$/,e.settings={acceptedFiles:"image/*",url:e.url}},controller:function(r){r.$watch("url",function(e){r.settings.url=e}),r.uploading=!1,r.uploadFlickrUrl=function(e){if(e.$valid){var t=/(https\:\/\/)?www\.flickr\.com\/photos\/.*\/\d+/.exec(r.flickrUrl)[0],i=l.post(r.url,{"flickr-url":t});i.success(function(e){r.pictureSuccess({picture:e})}).success(function(){e.$setPristine(),r.flickrUrl=""}),r.newUpload(i),r.upload={done:0,total:1,progress:0}}},r.newUpload=function(l){r.upload=null,r.uploading=!0,r.uploadPromise=l,l.then(function(){e.addSuccess({text:"Les images ont été uploadées avec succès"})},function(){e.add({type:e.type.WARNING,text:"Erreur lors de l'upload d'image"})},function(e){r.upload=e}).finally(function(){r.uploading=!1})}}}}])}(),function(e){"use strict";angular.module("ev-upload").directive("evUpload",["$log","$q",function(l,r){var t={clickable:".ev-upload-clickable",previewTemplate:!1,previewsContainer:!1,autoQueue:!0,maxFilesize:12,maxFiles:40,uploadMultiple:!1,parallelUploads:3};return{transclude:!0,restrict:"EA",replace:!0,scope:{settings:"=",uploadStart:"&upload",fileSuccess:"&"},template:'<div class="ev-upload"><div class="dz-default dz-message" ng-transclude> </div></div>',link:function(i,o){function n(e){return u.getAcceptedFiles().reduce(function(l,r){return l+r.upload[e]},0)}function d(e){a={done:0},u.off("totaluploadprogress").off("queuecomplete").off("maxfilesexceeded");var l={deferred:r.defer(),hasFileErrored:!1};u.on("error",function(){l.hasFileErrored=!0}),u.on("uploadprogress",function(){a.progress=100*n("bytesSent")/n("total"),a.total=u.getAcceptedFiles().length,l.deferred.notify(a)}),u.on("queuecomplete",function(){e.$apply(function(){l.hasFileErrored?l.deferred.reject("filehaserrored"):l.deferred.resolve()})}),u.on("maxfilesexceeded",function(){l.deferred.reject("maxfilesexceeded")}),e.currentUpload=l.deferred.promise,e.uploadStart({promise:l.deferred.promise}),e.currentUpload.finally(function(){u.removeAllFiles(!0),e.currentUpload=null})}var u=null,a=null;i.$watch("settings",function(r){return r.url?(null!==u&&u.destroy(),u=new e(o[0],angular.extend(t,r)),i.currentUpload=null,u.on("sending",function(){null===i.currentUpload&&i.$apply(d)}),void u.on("success",function(e,l){a.done+=1,i.$apply(function(e){e.fileSuccess({file:l})})})):void l.warn("No url provided to the upload zone")},!0),i.$on("$destroy",function(){u.destroy()})}}}])}(Dropzone);
//# sourceMappingURL=ev-fdm-upload.min.js.map
//# sourceMappingURL=ev-fdm.min.js.map